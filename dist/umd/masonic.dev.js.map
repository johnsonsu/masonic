{"version":3,"file":"masonic.dev.js","sources":["../../src/interval-tree.ts","../../node_modules/.pnpm/@react-hook+latest@1.0.3_react@17.0.2/node_modules/@react-hook/latest/src/index.tsx","../../node_modules/.pnpm/@react-hook+debounce@3.0.0_react@17.0.2/node_modules/@react-hook/debounce/src/index.tsx","../../node_modules/.pnpm/@react-hook+passive-layout-effect@1.2.1_react@17.0.2/node_modules/@react-hook/passive-layout-effect/src/index.tsx","../../node_modules/.pnpm/@react-hook+event@1.2.3_react@17.0.2/node_modules/@react-hook/event/src/index.tsx","../../node_modules/.pnpm/@react-hook+window-size@3.0.7_react@17.0.2/node_modules/@react-hook/window-size/src/index.tsx","../../node_modules/.pnpm/@essentials+memoize-one@1.1.0/node_modules/@essentials/memoize-one/src/index.ts","../../node_modules/.pnpm/@essentials+one-key-map@1.2.0/node_modules/@essentials/one-key-map/src/index.ts","../../node_modules/.pnpm/trie-memoize@1.2.0/node_modules/trie-memoize/src/index.ts","../../src/elements-cache.ts","../../src/use-force-update.ts","../../src/use-masonry.tsx","../../node_modules/.pnpm/@essentials+raf@1.2.0/node_modules/@essentials/raf/src/index.ts","../../node_modules/.pnpm/@essentials+request-timeout@1.3.0/node_modules/@essentials/request-timeout/src/index.ts","../../node_modules/.pnpm/@react-hook+throttle@2.2.0_react@17.0.2/node_modules/@react-hook/throttle/src/index.tsx","../../node_modules/.pnpm/@react-hook+window-scroll@1.3.0_react@17.0.2/node_modules/@react-hook/window-scroll/src/index.tsx","../../src/use-scroller.ts","../../src/masonry-scroller.tsx","../../src/use-container-position.ts","../../src/use-positioner.ts","../../node_modules/.pnpm/@juggle+resize-observer@3.3.1/node_modules/@juggle/resize-observer/lib/utils/resizeObservers.js","../../node_modules/.pnpm/@juggle+resize-observer@3.3.1/node_modules/@juggle/resize-observer/lib/algorithms/hasActiveObservations.js","../../node_modules/.pnpm/@juggle+resize-observer@3.3.1/node_modules/@juggle/resize-observer/lib/algorithms/hasSkippedObservations.js","../../node_modules/.pnpm/@juggle+resize-observer@3.3.1/node_modules/@juggle/resize-observer/lib/algorithms/deliverResizeLoopError.js","../../node_modules/.pnpm/@juggle+resize-observer@3.3.1/node_modules/@juggle/resize-observer/lib/ResizeObserverBoxOptions.js","../../node_modules/.pnpm/@juggle+resize-observer@3.3.1/node_modules/@juggle/resize-observer/lib/utils/freeze.js","../../node_modules/.pnpm/@juggle+resize-observer@3.3.1/node_modules/@juggle/resize-observer/lib/ResizeObserverSize.js","../../node_modules/.pnpm/@juggle+resize-observer@3.3.1/node_modules/@juggle/resize-observer/lib/DOMRectReadOnly.js","../../node_modules/.pnpm/@juggle+resize-observer@3.3.1/node_modules/@juggle/resize-observer/lib/utils/element.js","../../node_modules/.pnpm/@juggle+resize-observer@3.3.1/node_modules/@juggle/resize-observer/lib/utils/global.js","../../node_modules/.pnpm/@juggle+resize-observer@3.3.1/node_modules/@juggle/resize-observer/lib/algorithms/calculateBoxSize.js","../../node_modules/.pnpm/@juggle+resize-observer@3.3.1/node_modules/@juggle/resize-observer/lib/ResizeObserverEntry.js","../../node_modules/.pnpm/@juggle+resize-observer@3.3.1/node_modules/@juggle/resize-observer/lib/algorithms/calculateDepthForNode.js","../../node_modules/.pnpm/@juggle+resize-observer@3.3.1/node_modules/@juggle/resize-observer/lib/algorithms/broadcastActiveObservations.js","../../node_modules/.pnpm/@juggle+resize-observer@3.3.1/node_modules/@juggle/resize-observer/lib/algorithms/gatherActiveObservationsAtDepth.js","../../node_modules/.pnpm/@juggle+resize-observer@3.3.1/node_modules/@juggle/resize-observer/lib/utils/process.js","../../node_modules/.pnpm/@juggle+resize-observer@3.3.1/node_modules/@juggle/resize-observer/lib/utils/queueMicroTask.js","../../node_modules/.pnpm/@juggle+resize-observer@3.3.1/node_modules/@juggle/resize-observer/lib/utils/queueResizeObserver.js","../../node_modules/.pnpm/@juggle+resize-observer@3.3.1/node_modules/@juggle/resize-observer/lib/utils/scheduler.js","../../node_modules/.pnpm/@juggle+resize-observer@3.3.1/node_modules/@juggle/resize-observer/lib/ResizeObservation.js","../../node_modules/.pnpm/@juggle+resize-observer@3.3.1/node_modules/@juggle/resize-observer/lib/ResizeObserverDetail.js","../../node_modules/.pnpm/@juggle+resize-observer@3.3.1/node_modules/@juggle/resize-observer/lib/ResizeObserverController.js","../../node_modules/.pnpm/@juggle+resize-observer@3.3.1/node_modules/@juggle/resize-observer/lib/ResizeObserver.js","../../node_modules/.pnpm/raf-schd@4.0.3/node_modules/raf-schd/dist/raf-schd.esm.js","../../src/use-resize-observer.ts","../../src/use-scroll-to-index.ts","../../src/masonry.tsx","../../src/list.tsx","../../src/use-infinite-loader.ts"],"sourcesContent":["type Color = 0 | 1 | 2;\nconst RED = 0;\nconst BLACK = 1;\nconst NIL = 2;\n\nconst DELETE = 0;\nconst KEEP = 1;\n\ntype ListNode = {\n  index: number;\n  high: number;\n  next: ListNode | null;\n};\n\ninterface TreeNode {\n  max: number;\n  low: number;\n  high: number;\n  // color\n  C: Color;\n  // P\n  P: TreeNode;\n  // right\n  R: TreeNode;\n  // left\n  L: TreeNode;\n  list: ListNode;\n}\n\ninterface Tree {\n  root: TreeNode;\n  size: number;\n}\n\nfunction addInterval(treeNode: TreeNode, high: number, index: number): boolean {\n  let node: ListNode | null = treeNode.list;\n  let prevNode: ListNode | undefined;\n\n  while (node) {\n    if (node.index === index) return false;\n    if (high > node.high) break;\n    prevNode = node;\n    node = node.next;\n  }\n\n  if (!prevNode) treeNode.list = { index, high, next: node };\n  if (prevNode) prevNode.next = { index, high, next: prevNode.next };\n\n  return true;\n}\n\nfunction removeInterval(treeNode: TreeNode, index: number) {\n  let node: ListNode | null = treeNode.list;\n  if (node.index === index) {\n    if (node.next === null) return DELETE;\n    treeNode.list = node.next;\n    return KEEP;\n  }\n\n  let prevNode: ListNode | undefined = node;\n  node = node.next;\n\n  while (node !== null) {\n    if (node.index === index) {\n      prevNode.next = node.next;\n      return KEEP;\n    }\n    prevNode = node;\n    node = node.next;\n  }\n}\n\nconst NULL_NODE: TreeNode = {\n  low: 0,\n  max: 0,\n  high: 0,\n  C: NIL,\n  // @ts-expect-error\n  P: undefined,\n  // @ts-expect-error\n  R: undefined,\n  // @ts-expect-error\n  L: undefined,\n  // @ts-expect-error\n  list: undefined,\n};\n\nNULL_NODE.P = NULL_NODE;\nNULL_NODE.L = NULL_NODE;\nNULL_NODE.R = NULL_NODE;\n\nfunction updateMax(node: TreeNode) {\n  const max = node.high;\n  if (node.L === NULL_NODE && node.R === NULL_NODE) node.max = max;\n  else if (node.L === NULL_NODE) node.max = Math.max(node.R.max, max);\n  else if (node.R === NULL_NODE) node.max = Math.max(node.L.max, max);\n  else node.max = Math.max(Math.max(node.L.max, node.R.max), max);\n}\n\nfunction updateMaxUp(node: TreeNode) {\n  let x = node;\n\n  while (x.P !== NULL_NODE) {\n    updateMax(x.P);\n    x = x.P;\n  }\n}\n\nfunction rotateLeft(tree: Tree, x: TreeNode) {\n  if (x.R === NULL_NODE) return;\n  const y = x.R;\n  x.R = y.L;\n  if (y.L !== NULL_NODE) y.L.P = x;\n  y.P = x.P;\n\n  if (x.P === NULL_NODE) tree.root = y;\n  else {\n    if (x === x.P.L) x.P.L = y;\n    else x.P.R = y;\n  }\n\n  y.L = x;\n  x.P = y;\n\n  updateMax(x);\n  updateMax(y);\n}\n\nfunction rotateRight(tree: Tree, x: TreeNode) {\n  if (x.L === NULL_NODE) return;\n  const y = x.L;\n  x.L = y.R;\n  if (y.R !== NULL_NODE) y.R.P = x;\n  y.P = x.P;\n\n  if (x.P === NULL_NODE) tree.root = y;\n  else {\n    if (x === x.P.R) x.P.R = y;\n    else x.P.L = y;\n  }\n\n  y.R = x;\n  x.P = y;\n\n  updateMax(x);\n  updateMax(y);\n}\n\nfunction replaceNode(tree: Tree, x: TreeNode, y: TreeNode) {\n  if (x.P === NULL_NODE) tree.root = y;\n  else if (x === x.P.L) x.P.L = y;\n  else x.P.R = y;\n  y.P = x.P;\n}\n\nfunction fixRemove(tree: Tree, x: TreeNode) {\n  let w;\n\n  while (x !== NULL_NODE && x.C === BLACK) {\n    if (x === x.P.L) {\n      w = x.P.R;\n\n      if (w.C === RED) {\n        w.C = BLACK;\n        x.P.C = RED;\n        rotateLeft(tree, x.P);\n        w = x.P.R;\n      }\n\n      if (w.L.C === BLACK && w.R.C === BLACK) {\n        w.C = RED;\n        x = x.P;\n      } else {\n        if (w.R.C === BLACK) {\n          w.L.C = BLACK;\n          w.C = RED;\n          rotateRight(tree, w);\n          w = x.P.R;\n        }\n\n        w.C = x.P.C;\n        x.P.C = BLACK;\n        w.R.C = BLACK;\n        rotateLeft(tree, x.P);\n        x = tree.root;\n      }\n    } else {\n      w = x.P.L;\n\n      if (w.C === RED) {\n        w.C = BLACK;\n        x.P.C = RED;\n        rotateRight(tree, x.P);\n        w = x.P.L;\n      }\n\n      if (w.R.C === BLACK && w.L.C === BLACK) {\n        w.C = RED;\n        x = x.P;\n      } else {\n        if (w.L.C === BLACK) {\n          w.R.C = BLACK;\n          w.C = RED;\n          rotateLeft(tree, w);\n          w = x.P.L;\n        }\n\n        w.C = x.P.C;\n        x.P.C = BLACK;\n        w.L.C = BLACK;\n        rotateRight(tree, x.P);\n        x = tree.root;\n      }\n    }\n  }\n\n  x.C = BLACK;\n}\n\nfunction minimumTree(x: TreeNode) {\n  while (x.L !== NULL_NODE) x = x.L;\n  return x;\n}\n\nfunction fixInsert(tree: Tree, z: TreeNode) {\n  let y: TreeNode;\n  while (z.P.C === RED) {\n    if (z.P === z.P.P.L) {\n      y = z.P.P.R;\n\n      if (y.C === RED) {\n        z.P.C = BLACK;\n        y.C = BLACK;\n        z.P.P.C = RED;\n        z = z.P.P;\n      } else {\n        if (z === z.P.R) {\n          z = z.P;\n          rotateLeft(tree, z);\n        }\n\n        z.P.C = BLACK;\n        z.P.P.C = RED;\n        rotateRight(tree, z.P.P);\n      }\n    } else {\n      y = z.P.P.L;\n\n      if (y.C === RED) {\n        z.P.C = BLACK;\n        y.C = BLACK;\n        z.P.P.C = RED;\n        z = z.P.P;\n      } else {\n        if (z === z.P.L) {\n          z = z.P;\n          rotateRight(tree, z);\n        }\n\n        z.P.C = BLACK;\n        z.P.P.C = RED;\n        rotateLeft(tree, z.P.P);\n      }\n    }\n  }\n  tree.root.C = BLACK;\n}\n\nexport interface IIntervalTree {\n  insert(low: number, high: number, index: number): void;\n  remove(index: number): void;\n  search(\n    low: number,\n    high: number,\n    callback: (index: number, low: number) => any\n  ): void;\n  size: number;\n}\n\nexport function createIntervalTree(): IIntervalTree {\n  const tree = {\n    root: NULL_NODE,\n    size: 0,\n  };\n  // we know these indexes are a consistent, safe way to make look ups\n  // for our case so it's a solid O(1) alternative to\n  // the O(log n) searchNode() in typical interval trees\n  const indexMap: Record<number, TreeNode> = {};\n\n  return {\n    insert(low, high, index) {\n      let x: TreeNode = tree.root;\n      let y: TreeNode = NULL_NODE;\n\n      while (x !== NULL_NODE) {\n        y = x;\n        if (low === y.low) break;\n        if (low < x.low) x = x.L;\n        else x = x.R;\n      }\n\n      if (low === y.low && y !== NULL_NODE) {\n        if (!addInterval(y, high, index)) return;\n        y.high = Math.max(y.high, high);\n        updateMax(y);\n        updateMaxUp(y);\n        indexMap[index] = y;\n        tree.size++;\n        return;\n      }\n\n      const z: TreeNode = {\n        low,\n        high,\n        max: high,\n        C: RED,\n        P: y,\n        L: NULL_NODE,\n        R: NULL_NODE,\n        list: { index, high, next: null },\n      };\n\n      if (y === NULL_NODE) {\n        tree.root = z;\n      } else {\n        if (z.low < y.low) y.L = z;\n        else y.R = z;\n        updateMaxUp(z);\n      }\n\n      fixInsert(tree, z);\n      indexMap[index] = z;\n      tree.size++;\n    },\n\n    remove(index) {\n      const z = indexMap[index];\n      if (z === void 0) return;\n      delete indexMap[index];\n\n      const intervalResult = removeInterval(z, index);\n      if (intervalResult === void 0) return;\n      if (intervalResult === KEEP) {\n        z.high = z.list.high;\n        updateMax(z);\n        updateMaxUp(z);\n        tree.size--;\n        return;\n      }\n\n      let y = z;\n      let originalYColor = y.C;\n      let x: TreeNode;\n\n      if (z.L === NULL_NODE) {\n        x = z.R;\n        replaceNode(tree, z, z.R);\n      } else if (z.R === NULL_NODE) {\n        x = z.L;\n        replaceNode(tree, z, z.L);\n      } else {\n        y = minimumTree(z.R);\n        originalYColor = y.C;\n        x = y.R;\n\n        if (y.P === z) {\n          x.P = y;\n        } else {\n          replaceNode(tree, y, y.R);\n          y.R = z.R;\n          y.R.P = y;\n        }\n\n        replaceNode(tree, z, y);\n        y.L = z.L;\n        y.L.P = y;\n        y.C = z.C;\n      }\n\n      updateMax(x);\n      updateMaxUp(x);\n\n      if (originalYColor === BLACK) fixRemove(tree, x);\n      tree.size--;\n    },\n\n    search(low, high, callback) {\n      const stack = [tree.root];\n      while (stack.length !== 0) {\n        const node = stack.pop() as TreeNode;\n        if (node === NULL_NODE || low > node.max) continue;\n        if (node.L !== NULL_NODE) stack.push(node.L);\n        if (node.R !== NULL_NODE) stack.push(node.R);\n        if (node.low <= high && node.high >= low) {\n          let curr: ListNode | null = node.list;\n          while (curr !== null) {\n            if (curr.high >= low) callback(curr.index, node.low);\n            curr = curr.next;\n          }\n        }\n      }\n    },\n\n    get size() {\n      return tree.size;\n    },\n  };\n}\n","import * as React from 'react'\n\nconst useLatest = <T extends any>(current: T) => {\n  const storedValue = React.useRef(current)\n  React.useEffect(() => {\n    storedValue.current = current\n  })\n  return storedValue\n}\n\nexport default useLatest\n","import * as React from 'react'\nimport useLatest from '@react-hook/latest'\n\nexport const useDebounceCallback = <CallbackArgs extends any[]>(\n  callback: (...args: CallbackArgs) => void,\n  wait = 100,\n  leading = false\n): ((...args: CallbackArgs) => void) => {\n  const storedCallback = useLatest(callback)\n  const timeout = React.useRef<ReturnType<typeof setTimeout>>()\n  const deps = [wait, leading, storedCallback]\n  // Cleans up pending timeouts when the deps change\n  React.useEffect(\n    () => () => {\n      timeout.current && clearTimeout(timeout.current)\n      timeout.current = void 0\n    },\n    deps\n  )\n\n  return React.useCallback(function () {\n    // eslint-disable-next-line prefer-rest-params\n    const args = arguments\n    const {current} = timeout\n    // Calls on leading edge\n    if (current === void 0 && leading) {\n      timeout.current = setTimeout(() => {\n        timeout.current = void 0\n      }, wait)\n      // eslint-disable-next-line prefer-spread\n      return storedCallback.current.apply(null, args as any)\n    }\n    // Clear the timeout every call and start waiting again\n    current && clearTimeout(current)\n    // Waits for `wait` before invoking the callback\n    timeout.current = setTimeout(() => {\n      timeout.current = void 0\n      storedCallback.current.apply(null, args as any)\n    }, wait)\n  }, deps)\n}\n\nexport const useDebounce = <State extends any>(\n  initialState: State | (() => State),\n  wait?: number,\n  leading?: boolean\n): [State, React.Dispatch<React.SetStateAction<State>>] => {\n  const state = React.useState(initialState)\n  return [state[0], useDebounceCallback(state[1], wait, leading)]\n}\n","import React from 'react'\n\nconst usePassiveLayoutEffect =\n  React[\n    typeof document !== 'undefined' && document.createElement !== void 0\n      ? 'useLayoutEffect'\n      : 'useEffect'\n  ]\n\nexport default usePassiveLayoutEffect\n","import * as React from 'react'\nimport useLayoutEffect from '@react-hook/passive-layout-effect'\n\nfunction useEvent<\n  T extends Window = Window,\n  K extends keyof WindowEventMap = keyof WindowEventMap\n>(\n  target: Window | null,\n  type: K,\n  listener: WindowEventListener<K>,\n  cleanup?: (...args: any[]) => void\n): void\nfunction useEvent<\n  T extends Document = Document,\n  K extends keyof DocumentEventMap = keyof DocumentEventMap\n>(\n  target: Document | null,\n  type: K,\n  listener: DocumentEventListener<K>,\n  cleanup?: (...args: any[]) => void\n): void\nfunction useEvent<\n  T extends HTMLElement = HTMLElement,\n  K extends keyof HTMLElementEventMap = keyof HTMLElementEventMap\n>(\n  target: React.RefObject<T> | T | null,\n  type: K,\n  listener: ElementEventListener<K>,\n  cleanup?: (...args: any[]) => void\n): void\nfunction useEvent(target: any, type: any, listener: any, cleanup: any): void {\n  const storedListener = React.useRef(listener)\n  const storedCleanup = React.useRef(cleanup)\n\n  useLayoutEffect(() => {\n    storedListener.current = listener\n    storedCleanup.current = cleanup\n  })\n\n  useLayoutEffect(() => {\n    const targetEl = target && 'current' in target ? target.current : target\n    if (!targetEl) return\n\n    let didUnsubscribe = 0\n    function listener(this: any, ...args: any[]) {\n      if (didUnsubscribe) return\n      storedListener.current.apply(this, args)\n    }\n\n    targetEl.addEventListener(type, listener)\n    const cleanup = storedCleanup.current\n\n    return () => {\n      didUnsubscribe = 1\n      targetEl.removeEventListener(type, listener)\n      cleanup && cleanup()\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [target, type])\n}\n\nexport type ElementEventListener<\n  K extends keyof HTMLElementEventMap = keyof HTMLElementEventMap\n> = (this: HTMLElement, ev: HTMLElementEventMap[K]) => any\n\nexport type DocumentEventListener<\n  K extends keyof DocumentEventMap = keyof DocumentEventMap\n> = (this: Document, ev: DocumentEventMap[K]) => any\n\nexport type WindowEventListener<\n  K extends keyof WindowEventMap = keyof WindowEventMap\n> = (this: Document, ev: WindowEventMap[K]) => any\n\nexport default useEvent\n","import {useDebounce} from '@react-hook/debounce'\nimport useEvent from '@react-hook/event'\n\nconst emptyObj = {}\n\nexport interface DebouncedWindowSizeOptions {\n  initialWidth?: number\n  initialHeight?: number\n  wait?: number\n  leading?: boolean\n}\n\nconst win = typeof window === 'undefined' ? null : window\nconst getSize = () =>\n  [\n    document.documentElement.clientWidth,\n    document.documentElement.clientHeight,\n  ] as const\n\nexport const useWindowSize = (\n  options: DebouncedWindowSizeOptions = emptyObj\n): readonly [number, number] => {\n  const {wait, leading, initialWidth = 0, initialHeight = 0} = options\n  const [size, setDebouncedSize] = useDebounce<readonly [number, number]>(\n    /* istanbul ignore next */\n    typeof document === 'undefined' ? [initialWidth, initialHeight] : getSize,\n    wait,\n    leading\n  )\n  const setSize = (): void => setDebouncedSize(getSize)\n\n  useEvent(win, 'resize', setSize)\n  useEvent(win, 'orientationchange', setSize)\n\n  return size\n}\n\nexport const useWindowHeight = (\n  options?: Omit<DebouncedWindowSizeOptions, 'initialWidth'>\n): number => useWindowSize(options)[1]\n\nexport const useWindowWidth = (\n  options?: Omit<DebouncedWindowSizeOptions, 'initialHeight'>\n): number => useWindowSize(options)[0]\n","const memoOne = <Args extends any[], T extends any>(\n  fn: (...args: Args) => T,\n  areEqual?: AreEqual<Args>\n): OutputFunction<Args, T> => {\n  const equal = areEqual || defaultAreEqual\n  let args: Args, value: any\n\n  return function (): T {\n    return !!args && equal(arguments as any, args)\n      ? value\n      : (value = fn.apply(null, (args = arguments as any)))\n  } as OutputFunction<Args, T>\n}\n\nexport default memoOne\n\nconst defaultAreEqual = (\n  current: IArguments,\n  prev: IArguments | any[]\n): boolean =>\n  current[0] === prev[0] &&\n  current[1] === prev[1] &&\n  current[2] === prev[2] &&\n  current[3] === prev[3]\n\nexport type AreEqual<Args> = (currentArgs: Args, prevArgs: Args) => boolean\nexport type InputFunction = (...args: any[]) => any\nexport type OutputFunction<Args extends any[], T extends any> = (\n  ...args: Args\n) => T\n","class OneKeyMap<K extends any = any, V extends any = any> {\n  set: (k: K, v: V) => void\n  get: (k: K) => V | undefined\n\n  constructor() {\n    let key: K | undefined, val: V | undefined\n    this.get = (k: K): V | undefined => (k === key ? val : void 0)\n    this.set = (k: K, v: V): void => {\n      key = k\n      val = v\n    }\n  }\n}\n\nexport default OneKeyMap\n","export interface MapLike {\n  new (...args: any[]): any\n}\n\nexport type CacheConstructor =\n  | MapConstructor\n  | WeakMapConstructor\n  | MapLike\n  | Record<any, any>\n\ninterface Cache<K = any, V = any> {\n  set: (k: K, v: V) => V\n  get: (k: K) => V\n}\n\nconst createCache = (obj: CacheConstructor): Cache => {\n  try {\n    // @ts-ignore\n    return new obj()\n  } catch (e) {\n    const cache: Record<string, any> = {}\n\n    return {\n      set(k, v): void {\n        cache[k] = v\n      },\n      get(k): any {\n        return cache[k]\n      },\n    }\n  }\n}\n\nconst memo = (\n  constructors: CacheConstructor[]\n): {s: Cache['set']; g: Cache['get']} => {\n  const depth = constructors.length,\n    baseCache = createCache(constructors[0])\n  let base: any\n  let map: any\n  let i: number\n  let node: typeof baseCache\n  const one = depth === 1\n  // quicker access for one and two-argument functions\n  const g1 = (args: IArguments): any =>\n    (base = baseCache.get(args[0])) === void 0 || one ? base : base.get(args[1])\n  const s1 = (args: IArguments, value: any): any => {\n    if (one) baseCache.set(args[0], value)\n    else {\n      if ((base = baseCache.get(args[0])) === void 0) {\n        map = createCache(constructors[1])\n        map.set(args[1], value)\n        baseCache.set(args[0], map)\n      } else {\n        base.set(args[1], value)\n      }\n    }\n\n    return value\n  }\n\n  const g2 = (args: IArguments): any => {\n    node = baseCache\n\n    for (i = 0; i < depth; i++)\n      if ((node = node.get(args[i])) === void 0) return\n\n    return node\n  }\n\n  const s2 = (args: IArguments, value: any): any => {\n    node = baseCache\n\n    for (i = 0; i < depth - 1; i++) {\n      if ((map = node.get(args[i])) === void 0) {\n        map = createCache(constructors[i + 1])\n        node.set(args[i], map)\n        node = map\n      } else {\n        node = map\n      }\n    }\n\n    node.set(args[depth - 1], value)\n    return value\n  }\n\n  return depth < 3 ? {g: g1, s: s1} : {g: g2, s: s2}\n}\n\nconst memoize = <T extends any[], U extends any>(\n  mapConstructors: CacheConstructor[],\n  fn: (...args: T) => U\n): ((...args: T) => U) => {\n  let item: U\n  const {g, s} = memo(mapConstructors)\n  return function () {\n    return (item = g(arguments)) === void 0\n      ? s(arguments, fn.apply(null, arguments as any))\n      : item\n  }\n}\n\nexport default memoize\n","export const elementsCache: WeakMap<Element, number> = new WeakMap();\n","import * as React from \"react\";\n\nexport function useForceUpdate() {\n  const setState = React.useState(emptyObj)[1];\n  return React.useRef(() => setState({})).current;\n}\n\nconst emptyObj = {};\n","import memoizeOne from \"@essentials/memoize-one\";\nimport OneKeyMap from \"@essentials/one-key-map\";\nimport useLatest from \"@react-hook/latest\";\nimport * as React from \"react\";\nimport trieMemoize from \"trie-memoize\";\nimport { elementsCache } from \"./elements-cache\";\nimport { useForceUpdate } from \"./use-force-update\";\nimport type { Positioner } from \"./use-positioner\";\n\n/**\n * This hook handles the render phases of the masonry layout and returns the grid as a React element.\n *\n * @param options - Options for configuring the masonry layout renderer. See `UseMasonryOptions`.\n * @param options.positioner\n * @param options.resizeObserver\n * @param options.items\n * @param options.as\n * @param options.id\n * @param options.className\n * @param options.style\n * @param options.role\n * @param options.tabIndex\n * @param options.containerRef\n * @param options.itemAs\n * @param options.itemStyle\n * @param options.itemHeightEstimate\n * @param options.itemKey\n * @param options.overscanBy\n * @param options.scrollTop\n * @param options.isScrolling\n * @param options.height\n * @param options.render\n * @param options.onRender\n */\nexport function useMasonry<Item>({\n  // Measurement and layout\n  positioner,\n  resizeObserver,\n  // Grid items\n  items,\n  // Container props\n  as: ContainerComponent = \"div\",\n  id,\n  className,\n  style,\n  role = \"grid\",\n  tabIndex = 0,\n  containerRef,\n  // Item props\n  itemAs: ItemComponent = \"div\",\n  itemStyle,\n  itemHeightEstimate = 300,\n  itemKey = defaultGetItemKey,\n  // Rendering props\n  overscanBy = 2,\n  scrollTop,\n  isScrolling,\n  height,\n  render: RenderComponent,\n  onRender,\n}: UseMasonryOptions<Item>) {\n  let startIndex = 0;\n  let stopIndex: number | undefined;\n  const forceUpdate = useForceUpdate();\n  const setItemRef = getRefSetter(positioner, resizeObserver);\n  const itemCount = items.length;\n  const {\n    columnWidth,\n    columnCount,\n    range,\n    estimateHeight,\n    size,\n    shortestColumn,\n  } = positioner;\n  const measuredCount = size();\n  const shortestColumnSize = shortestColumn();\n  const children: React.ReactElement[] = [];\n  const itemRole =\n    role === \"list\" ? \"listitem\" : role === \"grid\" ? \"gridcell\" : undefined;\n  const storedOnRender = useLatest(onRender);\n\n  overscanBy = height * overscanBy;\n  const rangeEnd = scrollTop + overscanBy;\n  const needsFreshBatch =\n    shortestColumnSize < rangeEnd && measuredCount < itemCount;\n\n  range(\n    // We overscan in both directions because users scroll both ways,\n    // though one must admit scrolling down is more common and thus\n    // we only overscan by half the downward overscan amount\n    Math.max(0, scrollTop - overscanBy / 2),\n    rangeEnd,\n    (index, left, top) => {\n      const data = items[index];\n      const key = itemKey(data, index);\n      const phaseTwoStyle: React.CSSProperties = {\n        top,\n        left,\n        width: columnWidth,\n        writingMode: \"horizontal-tb\",\n        position: \"absolute\",\n      };\n\n      /* istanbul ignore next */\n      if (\n        typeof process !== \"undefined\" &&\n        process.env.NODE_ENV !== \"production\"\n      ) {\n        throwWithoutData(data, index);\n      }\n\n      children.push(\n        <ItemComponent\n          key={key}\n          ref={setItemRef(index)}\n          role={itemRole}\n          style={\n            typeof itemStyle === \"object\" && itemStyle !== null\n              ? Object.assign({}, phaseTwoStyle, itemStyle)\n              : phaseTwoStyle\n          }\n        >\n          {createRenderElement(RenderComponent, index, data, columnWidth)}\n        </ItemComponent>\n      );\n\n      if (stopIndex === void 0) {\n        startIndex = index;\n        stopIndex = index;\n      } else {\n        startIndex = Math.min(startIndex, index);\n        stopIndex = Math.max(stopIndex, index);\n      }\n    }\n  );\n\n  if (needsFreshBatch) {\n    const batchSize = Math.min(\n      itemCount - measuredCount,\n      Math.ceil(\n        ((scrollTop + overscanBy - shortestColumnSize) / itemHeightEstimate) *\n          columnCount\n      )\n    );\n\n    let index = measuredCount;\n    const phaseOneStyle = getCachedSize(columnWidth);\n\n    for (; index < measuredCount + batchSize; index++) {\n      const data = items[index];\n      const key = itemKey(data, index);\n\n      /* istanbul ignore next */\n      if (\n        typeof process !== \"undefined\" &&\n        process.env.NODE_ENV !== \"production\"\n      ) {\n        throwWithoutData(data, index);\n      }\n\n      children.push(\n        <ItemComponent\n          key={key}\n          ref={setItemRef(index)}\n          role={itemRole}\n          style={\n            typeof itemStyle === \"object\"\n              ? Object.assign({}, phaseOneStyle, itemStyle)\n              : phaseOneStyle\n          }\n        >\n          {createRenderElement(RenderComponent, index, data, columnWidth)}\n        </ItemComponent>\n      );\n    }\n  }\n\n  // Calls the onRender callback if the rendered indices changed\n  React.useEffect(() => {\n    if (typeof storedOnRender.current === \"function\" && stopIndex !== void 0)\n      storedOnRender.current(startIndex, stopIndex, items);\n\n    didEverMount = \"1\";\n  }, [startIndex, stopIndex, items, storedOnRender]);\n  // If we needed a fresh batch we should reload our components with the measured\n  // sizes\n  React.useEffect(() => {\n    if (needsFreshBatch) forceUpdate();\n    // eslint-disable-next-line\n  }, [needsFreshBatch]);\n\n  // gets the container style object based upon the estimated height and whether or not\n  // the page is being scrolled\n  const containerStyle = getContainerStyle(\n    isScrolling,\n    estimateHeight(itemCount, itemHeightEstimate)\n  );\n\n  return (\n    <ContainerComponent\n      ref={containerRef}\n      key={didEverMount}\n      id={id}\n      role={role}\n      className={className}\n      tabIndex={tabIndex}\n      style={\n        typeof style === \"object\"\n          ? assignUserStyle(containerStyle, style)\n          : containerStyle\n      }\n      children={children}\n    />\n  );\n}\n\n/* istanbul ignore next */\nfunction throwWithoutData(data: any, index: number) {\n  if (!data) {\n    throw new Error(\n      `No data was found at index: ${index}\\n\\n` +\n        `This usually happens when you've mutated or changed the \"items\" array in a ` +\n        `way that makes it shorter than the previous \"items\" array. Masonic knows nothing ` +\n        `about your underlying data and when it caches cell positions, it assumes you aren't ` +\n        `mutating the underlying \"items\".\\n\\n` +\n        `See https://codesandbox.io/s/masonic-w-react-router-example-2b5f9?file=/src/index.js for ` +\n        `an example that gets around this limitations. For advanced implementations, see ` +\n        `https://codesandbox.io/s/masonic-w-react-router-and-advanced-config-example-8em42?file=/src/index.js\\n\\n` +\n        `If this was the result of your removing an item from your \"items\", see this issue: ` +\n        `https://github.com/jaredLunde/masonic/issues/12`\n    );\n  }\n}\n\n// This is for triggering a remount after SSR has loaded in the client w/ hydrate()\nlet didEverMount = \"0\";\n\nexport interface UseMasonryOptions<Item> {\n  /**\n   * An array containing the data used by the grid items.\n   */\n  items: Item[];\n  /**\n   * A grid cell positioner and cache created by the `usePositioner()` hook or\n   * the `createPositioner` utility.\n   */\n  positioner: Positioner;\n  /**\n   * A resize observer that tracks mutations to the grid cells and forces the\n   * Masonry grid to recalculate its layout if any cells affect column heights\n   * change. Check out the `useResizeObserver()` hook.\n   */\n  resizeObserver?: {\n    observe: ResizeObserver[\"observe\"];\n    disconnect: ResizeObserver[\"observe\"];\n    unobserve: ResizeObserver[\"unobserve\"];\n  };\n  /**\n   * This is the type of element the grid container will be rendered as.\n   *\n   * @default \"div\"`\n   */\n  as?: keyof JSX.IntrinsicElements | React.ComponentType<any>;\n  /**\n   * Optionally gives the grid container an `id` prop.\n   */\n  id?: string;\n  /**\n   * Optionally gives the grid container a `className` prop.\n   */\n  className?: string;\n  /**\n   * Adds extra `style` attributes to the container in addition to those\n   * created by the `useMasonry()` hook.\n   */\n  style?: React.CSSProperties;\n  /**\n   * Optionally swap out the accessibility `role` prop of the container and its items.\n   *\n   * @default \"grid\"\n   */\n  role?: \"grid\" | \"list\";\n  /**\n   * Change the `tabIndex` of the grid container.\n   *\n   * @default 0\n   */\n  tabIndex?: number;\n  /**\n   * Forwards a React ref to the grid container.\n   */\n  containerRef?:\n    | ((element: HTMLElement) => void)\n    | React.MutableRefObject<HTMLElement | null>;\n  /**\n   * This is the type of element the grid items will be rendered as.\n   *\n   * @default \"div\"\n   */\n  itemAs?: keyof JSX.IntrinsicElements | React.ComponentType<any>;\n  /**\n   * Adds extra `style` attributes to the grid items in addition to those\n   * created by the `useMasonry()` hook.\n   */\n  itemStyle?: React.CSSProperties;\n  /**\n   * This value is used for estimating the initial height of the masonry grid. It is important for\n   * the UX of the scrolling behavior and in determining how many `items` to render in a batch, so it's\n   * wise to set this value with some level accuracy, though it doesn't need to be perfect.\n   *\n   * @default 300\n   */\n  itemHeightEstimate?: number;\n  /**\n   * The value returned here must be unique to the item. By default, the key is the item's index. This is ok\n   * if your collection of items is never modified. Setting this property ensures that the component in `render`\n   * is reused each time the masonry grid is reflowed. A common pattern would be to return the item's database\n   * ID here if there is one, e.g. `data => data.id`\n   *\n   * @default (data, index) => index`\n   */\n  itemKey?: (data: Item, index: number) => string | number;\n  /**\n   * This number is used for determining the number of grid cells outside of the visible window to render.\n   * The default value is `2` which means \"render 2 windows worth (2 * `height`) of content before and after\n   * the items in the visible window\". A value of `3` would be 3 windows worth of grid cells, so it's a\n   * linear relationship.\n   *\n   * Overscanning is important for preventing tearing when scrolling through items in the grid, but setting\n   * too high of a vaimport { useForceUpdate } from './use-force-update';\nlue may create too much work for React to handle, so it's best that you tune this\n   * value accordingly.\n   *\n   * @default 2\n   */\n  overscanBy?: number;\n\n  /**\n   * This is the height of the window. If you're rendering the grid relative to the browser `window`,\n   * the current `document.documentElement.clientHeight` is the value you'll want to set here. If you're\n   * rendering the grid inside of another HTML element, you'll want to provide the current `element.offsetHeight`\n   * here.\n   */\n  height: number;\n  /**\n   * The current scroll progress in pixel of the window the grid is rendered in. If you're rendering\n   * the grid relative to the browser `window`, you'll want the most current `window.scrollY` here.\n   * If you're rendering the grid inside of another HTML element, you'll want the current `element.scrollTop`\n   * value here. The `useScroller()` hook and `<MasonryScroller>` components will help you if you're\n   * rendering the grid relative to the browser `window`.\n   */\n  scrollTop: number;\n  /**\n   * This property is used for determining whether or not the grid container should add styles that\n   * dramatically increase scroll performance. That is, turning off `pointer-events` and adding a\n   * `will-change: contents;` value to the style string. You can forgo using this prop, but I would\n   * not recommend that. The `useScroller()` hook and `<MasonryScroller>` components will help you if\n   * you're rendering the grid relative to the browser `window`.\n   *\n   * @default false\n   */\n  isScrolling?: boolean;\n  /**\n   * This component is rendered for each item of your `items` prop array. It should accept three props:\n   * `index`, `width`, and `data`. See RenderComponentProps.\n   */\n  render: React.ComponentType<RenderComponentProps<Item>>;\n  /**\n   * This callback is invoked any time the items currently being rendered by the grid change.\n   */\n  onRender?: (startIndex: number, stopIndex: number, items: Item[]) => void;\n}\n\nexport interface RenderComponentProps<Item> {\n  /**\n   * The index of the cell in the `items` prop array.\n   */\n  index: number;\n  /**\n   * The rendered width of the cell's column.\n   */\n  width: number;\n  /**\n   * The data at `items[index]` of your `items` prop array.\n   */\n  data: Item;\n}\n\n//\n// Render-phase utilities\n\n// ~5.5x faster than createElement without the memo\nconst createRenderElement = trieMemoize(\n  [OneKeyMap, {}, WeakMap, OneKeyMap],\n  (RenderComponent, index, data, columnWidth) => (\n    <RenderComponent index={index} data={data} width={columnWidth} />\n  )\n);\n\nconst getContainerStyle = memoizeOne(\n  (isScrolling: boolean | undefined, estimateHeight: number) => ({\n    position: \"relative\",\n    width: \"100%\",\n    maxWidth: \"100%\",\n    height: Math.ceil(estimateHeight),\n    maxHeight: Math.ceil(estimateHeight),\n    willChange: isScrolling ? \"contents\" : void 0,\n    pointerEvents: isScrolling ? \"none\" : void 0,\n  })\n);\n\nconst cmp2 = (args: IArguments, pargs: IArguments | any[]): boolean =>\n  args[0] === pargs[0] && args[1] === pargs[1];\n\nconst assignUserStyle = memoizeOne(\n  (containerStyle, userStyle) => Object.assign({}, containerStyle, userStyle),\n  // @ts-expect-error\n  cmp2\n);\n\nfunction defaultGetItemKey<Item>(_: Item, i: number) {\n  return i;\n}\n\n// the below memoizations for for ensuring shallow equal is reliable for pure\n// component children\nconst getCachedSize = memoizeOne(\n  (width: number): React.CSSProperties => ({\n    width,\n    zIndex: -1000,\n    visibility: \"hidden\",\n    position: \"absolute\",\n    writingMode: \"horizontal-tb\",\n  }),\n  (args, pargs) => args[0] === pargs[0]\n);\n\nconst getRefSetter = memoizeOne(\n  (\n      positioner: Positioner,\n      resizeObserver?: UseMasonryOptions<any>[\"resizeObserver\"]\n    ) =>\n    (index: number) =>\n    (el: HTMLElement | null): void => {\n      if (el === null) return;\n      if (resizeObserver) {\n        resizeObserver.observe(el);\n        elementsCache.set(el, index);\n      }\n      if (positioner.get(index) === void 0)\n        positioner.set(index, el.offsetHeight);\n    },\n  // @ts-expect-error\n  cmp2\n);\n","export type Raf = (callback: (timestamp: number) => void) => number\nexport type Caf = (handle: number) => void\n\nlet u = 'undefined',\n  win = typeof window !== u ? window : ({} as any),\n  p = typeof performance !== u ? performance : Date,\n  now = () => p.now(),\n  af = 'AnimationFrame' as const,\n  Caf = 'cancel' + af,\n  Raf = 'request' + af,\n  raf: Raf = win[Raf] && win[Raf].bind(win),\n  caf: Caf = win[Caf] && win[Caf].bind(win)\n\nif (!raf || !caf) {\n  let lastTime = 0\n  raf = (callback: FrameRequestCallback) => {\n    let curr = now(),\n      next = Math.max(lastTime + 1000 / 60, curr)\n    return setTimeout(() => {\n      callback((lastTime = next))\n    }, next - curr) as any\n  }\n  caf = (h) => clearTimeout(h)\n}\n\nexport {raf, caf, now}\n","/**\n * Copyright 2011, Joe Lambert.\n * Free to use under the MIT license.\n * http://www.opensource.org/licenses/mit-license.php\n **/\nimport {raf, caf, now} from '@essentials/raf'\n\nexport interface RequestTimeoutHandle {\n  v?: number\n}\n\nexport const clearRequestTimeout = (handle: RequestTimeoutHandle): void => {\n  caf(handle.v || -1)\n}\n\nexport const requestTimeout = (\n  fn: (...args: any[]) => void,\n  ms: number\n): RequestTimeoutHandle => {\n  const start = now(),\n    handle: RequestTimeoutHandle = {}\n\n  const loop = () => {\n    now() - start >= ms ? fn.call(null) : (handle.v = raf(loop))\n  }\n\n  handle.v = raf(loop)\n  return handle\n}\n\nexport default requestTimeout\n","import * as React from 'react'\nimport useLatest from '@react-hook/latest'\n\nconst perf = typeof performance !== 'undefined' ? performance : Date\nconst now = () => perf.now()\n\nexport function useThrottleCallback<CallbackArguments extends any[]>(\n  callback: (...args: CallbackArguments) => void,\n  fps = 30,\n  leading = false\n): (...args: CallbackArguments) => void {\n  const storedCallback = useLatest(callback)\n  const ms = 1000 / fps\n  const prev = React.useRef(0)\n  const trailingTimeout = React.useRef<ReturnType<typeof setTimeout>>()\n  const clearTrailing = () =>\n    trailingTimeout.current && clearTimeout(trailingTimeout.current)\n  const deps = [fps, leading, storedCallback]\n\n  // Reset any time the deps change\n  React.useEffect(\n    () => () => {\n      prev.current = 0\n      clearTrailing()\n    },\n    deps\n  )\n\n  return React.useCallback(function () {\n    // eslint-disable-next-line prefer-rest-params\n    const args = arguments\n    const rightNow = now()\n    const call = () => {\n      prev.current = rightNow\n      clearTrailing()\n      storedCallback.current.apply(null, args as any)\n    }\n    const current = prev.current\n    // leading\n    if (leading && current === 0) return call()\n    // body\n    if (rightNow - current > ms) {\n      if (current > 0) return call()\n      prev.current = rightNow\n    }\n    // trailing\n    clearTrailing()\n    trailingTimeout.current = setTimeout(() => {\n      call()\n      prev.current = 0\n    }, ms)\n  }, deps)\n}\n\nexport function useThrottle<State>(\n  initialState: State | (() => State),\n  fps?: number,\n  leading?: boolean\n): [State, React.Dispatch<React.SetStateAction<State>>] {\n  const state = React.useState<State>(initialState)\n  return [state[0], useThrottleCallback(state[1], fps, leading)]\n}\n","import {useThrottle} from '@react-hook/throttle'\nimport useEvent from '@react-hook/event'\n\nconst win = typeof window === 'undefined' ? null : window\nconst getScrollY = (): number =>\n  (win as Window).scrollY !== void 0\n    ? (win as Window).scrollY\n    : (win as Window).pageYOffset === void 0\n    ? 0\n    : (win as Window).pageYOffset\n\nexport const useWindowScroll = (fps = 30): number => {\n  const state = useThrottle(\n    typeof window === 'undefined' ? 0 : getScrollY,\n    fps,\n    true\n  )\n  useEvent(win, 'scroll', (): void => state[1](getScrollY()))\n  return state[0]\n}\n\nexport default useWindowScroll\n","import {\n  clearRequestTimeout,\n  requestTimeout,\n} from \"@essentials/request-timeout\";\nimport useScrollPosition from \"@react-hook/window-scroll\";\nimport * as React from \"react\";\n\n/**\n * A hook for tracking whether the `window` is currently being scrolled and it's scroll position on\n * the y-axis. These values are used for determining which grid cells to render and when\n * to add styles to the masonry container that maximize scroll performance.\n *\n * @param offset - The vertical space in pixels between the top of the grid container and the top\n *  of the browser `document.documentElement`.\n * @param fps - This determines how often (in frames per second) to update the scroll position of the\n *  browser `window` in state, and as a result the rate the masonry grid recalculates its visible cells.\n *  The default value of `12` has been very reasonable in my own testing, but if you have particularly\n *  heavy `render` components it may be prudent to reduce this number.\n */\nexport function useScroller(\n  offset = 0,\n  fps = 12\n): { scrollTop: number; isScrolling: boolean } {\n  const scrollTop = useScrollPosition(fps);\n  const [isScrolling, setIsScrolling] = React.useState(false);\n  const didMount = React.useRef(0);\n\n  React.useEffect(() => {\n    if (didMount.current === 1) setIsScrolling(true);\n    let didUnsubscribe = false;\n    const to = requestTimeout(() => {\n      if (didUnsubscribe) return;\n      // This is here to prevent premature bail outs while maintaining high resolution\n      // unsets. Without it there will always bee a lot of unnecessary DOM writes to style.\n      setIsScrolling(false);\n    }, 40 + 1000 / fps);\n    didMount.current = 1;\n    return () => {\n      didUnsubscribe = true;\n      clearRequestTimeout(to);\n    };\n  }, [fps, scrollTop]);\n\n  return { scrollTop: Math.max(0, scrollTop - offset), isScrolling };\n}\n","import { useMasonry } from \"./use-masonry\";\nimport type { UseMasonryOptions } from \"./use-masonry\";\nimport { useScroller } from \"./use-scroller\";\n/**\n * A heavily-optimized component that updates `useMasonry()` when the scroll position of the browser `window`\n * changes. This bare-metal component is used by `<Masonry>` under the hood.\n *\n * @param props\n */\nexport function MasonryScroller<Item>(props: MasonryScrollerProps<Item>) {\n  // We put this in its own layer because it's the thing that will trigger the most updates\n  // and we don't want to slower ourselves by cycling through all the functions, objects, and effects\n  // of other hooks\n  const { scrollTop, isScrolling } = useScroller(props.offset, props.scrollFps);\n  // This is an update-heavy phase and while we could just Object.assign here,\n  // it is way faster to inline and there's a relatively low hit to he bundle\n  // size.\n  return useMasonry<Item>({\n    scrollTop,\n    isScrolling,\n    positioner: props.positioner,\n    resizeObserver: props.resizeObserver,\n    items: props.items,\n    onRender: props.onRender,\n    as: props.as,\n    id: props.id,\n    className: props.className,\n    style: props.style,\n    role: props.role,\n    tabIndex: props.tabIndex,\n    containerRef: props.containerRef,\n    itemAs: props.itemAs,\n    itemStyle: props.itemStyle,\n    itemHeightEstimate: props.itemHeightEstimate,\n    itemKey: props.itemKey,\n    overscanBy: props.overscanBy,\n    height: props.height,\n    render: props.render,\n  });\n}\n\nexport interface MasonryScrollerProps<Item>\n  extends Omit<UseMasonryOptions<Item>, \"scrollTop\" | \"isScrolling\"> {\n  /**\n   * This determines how often (in frames per second) to update the scroll position of the\n   * browser `window` in state, and as a result the rate the masonry grid recalculates its visible cells.\n   * The default value of `12` has been very reasonable in my own testing, but if you have particularly\n   * heavy `render` components it may be prudent to reduce this number.\n   *\n   * @default 12\n   */\n  scrollFps?: number;\n  /**\n   * The vertical space in pixels between the top of the grid container and the top\n   * of the browser `document.documentElement`.\n   *\n   * @default 0\n   */\n  offset?: number;\n}\n\nif (typeof process !== \"undefined\" && process.env.NODE_ENV !== \"production\") {\n  MasonryScroller.displayName = \"MasonryScroller\";\n}\n","import useLayoutEffect from \"@react-hook/passive-layout-effect\";\nimport * as React from \"react\";\n\n/**\n * A hook for measuring the width of the grid container, as well as its distance\n * from the top of the document. These values are necessary to correctly calculate the number/width\n * of columns to render, as well as the number of rows to render.\n *\n * @param elementRef - A `ref` object created by `React.useRef()`. That ref should be provided to the\n *   `containerRef` property in `useMasonry()`.\n * @param deps - You can force this hook to recalculate the `offset` and `width` whenever this\n *   dependencies list changes. A common dependencies list might look like `[windowWidth, windowHeight]`,\n *   which would force the hook to recalculate any time the size of the browser `window` changed.\n */\nexport function useContainerPosition(\n  elementRef: React.MutableRefObject<HTMLElement | null>,\n  deps: React.DependencyList = emptyArr\n): ContainerPosition {\n  const [containerPosition, setContainerPosition] =\n    React.useState<ContainerPosition>({ offset: 0, width: 0 });\n\n  useLayoutEffect(() => {\n    const { current } = elementRef;\n    if (current !== null) {\n      let offset = 0;\n      let el = current;\n\n      do {\n        offset += el.offsetTop || 0;\n        el = el.offsetParent as HTMLElement;\n      } while (el);\n\n      if (\n        offset !== containerPosition.offset ||\n        current.offsetWidth !== containerPosition.width\n      ) {\n        setContainerPosition({\n          offset,\n          width: current.offsetWidth,\n        });\n      }\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, deps);\n\n  return containerPosition;\n}\n\nexport interface ContainerPosition {\n  /**\n   * The distance in pixels between the top of the element in `elementRef` and the top of\n   * the `document.documentElement`.\n   */\n  offset: number;\n  /**\n   * The `offsetWidth` of the element in `elementRef`.\n   */\n  width: number;\n}\n\nconst emptyArr: [] = [];\n","import * as React from \"react\";\nimport { createIntervalTree } from \"./interval-tree\";\n\n/**\n * This hook creates the grid cell positioner and cache required by `useMasonry()`. This is\n * the meat of the grid's layout algorithm, determining which cells to render at a given scroll\n * position, as well as where to place new items in the grid.\n *\n * @param options - Properties that determine the number of columns in the grid, as well\n *  as their widths.\n * @param options.columnWidth\n * @param options.width\n * @param deps - This hook will create a new positioner, clearing all existing cached positions,\n *  whenever the dependencies in this list change.\n * @param options.columnGutter\n * @param options.rowGutter\n * @param options.columnCount\n */\nexport function usePositioner(\n  {\n    width,\n    columnWidth = 200,\n    columnGutter = 0,\n    rowGutter,\n    columnCount,\n  }: UsePositionerOptions,\n  deps: React.DependencyList = emptyArr\n): Positioner {\n  const initPositioner = (): Positioner => {\n    const [computedColumnWidth, computedColumnCount] = getColumns(\n      width,\n      columnWidth,\n      columnGutter,\n      columnCount\n    );\n    return createPositioner(\n      computedColumnCount,\n      computedColumnWidth,\n      columnGutter,\n      rowGutter ?? columnGutter\n    );\n  };\n  const positionerRef = React.useRef<Positioner>();\n  if (positionerRef.current === undefined)\n    positionerRef.current = initPositioner();\n\n  const prevDeps = React.useRef(deps);\n  const opts = [width, columnWidth, columnGutter, rowGutter, columnCount];\n  const prevOpts = React.useRef(opts);\n  const optsChanged = !opts.every((item, i) => prevOpts.current[i] === item);\n\n  if (typeof process !== \"undefined\" && process.env.NODE_ENV !== \"production\") {\n    if (deps.length !== prevDeps.current.length) {\n      throw new Error(\n        \"usePositioner(): The length of your dependencies array changed.\"\n      );\n    }\n  }\n\n  // Create a new positioner when the dependencies or sizes change\n  // Thanks to https://github.com/khmm12 for pointing this out\n  // https://github.com/jaredLunde/masonic/pull/41\n  if (optsChanged || !deps.every((item, i) => prevDeps.current[i] === item)) {\n    const prevPositioner = positionerRef.current;\n    const positioner = initPositioner();\n    prevDeps.current = deps;\n    prevOpts.current = opts;\n\n    if (optsChanged) {\n      const cacheSize = prevPositioner.size();\n      for (let index = 0; index < cacheSize; index++) {\n        const pos = prevPositioner.get(index);\n        positioner.set(index, pos !== void 0 ? pos.height : 0);\n      }\n    }\n\n    positionerRef.current = positioner;\n  }\n\n  return positionerRef.current;\n}\n\nexport interface UsePositionerOptions {\n  /**\n   * The width of the container you're rendering the grid within, i.e. the container\n   * element's `element.offsetWidth`\n   */\n  width: number;\n  /**\n   * The minimum column width. The `usePositioner()` hook will automatically size the\n   * columns to fill their container based upon the `columnWidth` and `columnGutter` values.\n   * It will never render anything smaller than this width unless its container itself is\n   * smaller than its value. This property is optional if you're using a static `columnCount`.\n   *\n   * @default 200\n   */\n  columnWidth?: number;\n  /**\n   * This sets the horizontal space between grid columns in pixels. If `rowGutter` is not set, this\n   * also sets the vertical space between cells within a column in pixels.\n   *\n   * @default 0\n   */\n  columnGutter?: number;\n  /**\n   * This sets the vertical space between cells within a column in pixels. If not set, the value of\n   * `columnGutter` is used instead.\n   */\n  rowGutter?: number;\n  /**\n   * By default, `usePositioner()` derives the column count from the `columnWidth`, `columnGutter`,\n   * and `width` props. However, in some situations it is nice to be able to override that behavior\n   * (e.g. creating a `List` component).\n   */\n  columnCount?: number;\n}\n\n/**\n * Creates a cell positioner for the `useMasonry()` hook. The `usePositioner()` hook uses\n * this utility under the hood.\n *\n * @param columnCount - The number of columns in the grid\n * @param columnWidth - The width of each column in the grid\n * @param columnGutter - The amount of horizontal space between columns in pixels.\n * @param rowGutter - The amount of vertical space between cells within a column in pixels (falls back\n * to `columnGutter`).\n */\nexport const createPositioner = (\n  columnCount: number,\n  columnWidth: number,\n  columnGutter = 0,\n  rowGutter = columnGutter\n): Positioner => {\n  // O(log(n)) lookup of cells to render for a given viewport size\n  // Store tops and bottoms of each cell for fast intersection lookup.\n  const intervalTree = createIntervalTree();\n  // Track the height of each column.\n  // Layout algorithm below always inserts into the shortest column.\n  const columnHeights: number[] = new Array(columnCount);\n  // Used for O(1) item access\n  const items: PositionerItem[] = [];\n  // Tracks the item indexes within an individual column\n  const columnItems: number[][] = new Array(columnCount);\n\n  for (let i = 0; i < columnCount; i++) {\n    columnHeights[i] = 0;\n    columnItems[i] = [];\n  }\n\n  return {\n    columnCount,\n    columnWidth,\n    set: (index, height = 0) => {\n      let column = 0;\n\n      // finds the shortest column and uses it\n      for (let i = 1; i < columnHeights.length; i++) {\n        if (columnHeights[i] < columnHeights[column]) column = i;\n      }\n\n      const top = columnHeights[column] || 0;\n      columnHeights[column] = top + height + rowGutter;\n      columnItems[column].push(index);\n      items[index] = {\n        left: column * (columnWidth + columnGutter),\n        top,\n        height,\n        column,\n      };\n      intervalTree.insert(top, top + height, index);\n    },\n    get: (index) => items[index],\n    // This only updates items in the specific columns that have changed, on and after the\n    // specific items that have changed\n    update: (updates) => {\n      const columns: number[] = new Array(columnCount);\n      let i = 0,\n        j = 0;\n\n      // determines which columns have items that changed, as well as the minimum index\n      // changed in that column, as all items after that index will have their positions\n      // affected by the change\n      for (; i < updates.length - 1; i++) {\n        const index = updates[i];\n        const item = items[index];\n        item.height = updates[++i];\n        intervalTree.remove(index);\n        intervalTree.insert(item.top, item.top + item.height, index);\n        columns[item.column] =\n          columns[item.column] === void 0\n            ? index\n            : Math.min(index, columns[item.column]);\n      }\n\n      for (i = 0; i < columns.length; i++) {\n        // bails out if the column didn't change\n        if (columns[i] === void 0) continue;\n        const itemsInColumn = columnItems[i];\n        // the index order is sorted with certainty so binary search is a great solution\n        // here as opposed to Array.indexOf()\n        const startIndex = binarySearch(itemsInColumn, columns[i]);\n        const index = columnItems[i][startIndex];\n        const startItem = items[index];\n        columnHeights[i] = startItem.top + startItem.height + rowGutter;\n\n        for (j = startIndex + 1; j < itemsInColumn.length; j++) {\n          const index = itemsInColumn[j];\n          const item = items[index];\n          item.top = columnHeights[i];\n          columnHeights[i] = item.top + item.height + rowGutter;\n          intervalTree.remove(index);\n          intervalTree.insert(item.top, item.top + item.height, index);\n        }\n      }\n    },\n    // Render all cells visible within the viewport range defined.\n    range: (lo, hi, renderCallback) =>\n      intervalTree.search(lo, hi, (index, top) =>\n        renderCallback(index, items[index].left, top)\n      ),\n    estimateHeight: (itemCount, defaultItemHeight): number => {\n      const tallestColumn = Math.max(0, Math.max.apply(null, columnHeights));\n\n      return itemCount === intervalTree.size\n        ? tallestColumn\n        : tallestColumn +\n            Math.ceil((itemCount - intervalTree.size) / columnCount) *\n              defaultItemHeight;\n    },\n    shortestColumn: () => {\n      if (columnHeights.length > 1) return Math.min.apply(null, columnHeights);\n      return columnHeights[0] || 0;\n    },\n    size(): number {\n      return intervalTree.size;\n    },\n    all(): PositionerItem[] {\n      return items;\n    },\n  };\n};\n\nexport interface Positioner {\n  /**\n   * The number of columns in the grid\n   */\n  columnCount: number;\n  /**\n   * The width of each column in the grid\n   */\n  columnWidth: number;\n  /**\n   * Sets the position for the cell at `index` based upon the cell's height\n   */\n  set: (index: number, height: number) => void;\n  /**\n   * Gets the `PositionerItem` for the cell at `index`\n   */\n  get: (index: number) => PositionerItem | undefined;\n  /**\n   * Updates cells based on their indexes and heights\n   * positioner.update([index, height, index, height, index, height...])\n   */\n  update: (updates: number[]) => void;\n  /**\n   * Searches the interval tree for grid cells with a `top` value in\n   * betwen `lo` and `hi` and invokes the callback for each item that\n   * is discovered\n   */\n  range: (\n    lo: number,\n    hi: number,\n    renderCallback: (index: number, left: number, top: number) => void\n  ) => void;\n  /**\n   * Returns the number of grid cells in the cache\n   */\n\n  size: () => number;\n  /**\n   * Estimates the total height of the grid\n   */\n\n  estimateHeight: (itemCount: number, defaultItemHeight: number) => number;\n  /**\n   * Returns the height of the shortest column in the grid\n   */\n\n  shortestColumn: () => number;\n  /**\n   * Returns all `PositionerItem` items\n   */\n  all: () => PositionerItem[];\n}\n\nexport interface PositionerItem {\n  /**\n   * This is how far from the top edge of the grid container in pixels the\n   * item is placed\n   */\n  top: number;\n  /**\n   * This is how far from the left edge of the grid container in pixels the\n   * item is placed\n   */\n  left: number;\n  /**\n   * This is the height of the grid cell\n   */\n  height: number;\n  /**\n   * This is the column number containing the grid cell\n   */\n  column: number;\n}\n\n/* istanbul ignore next */\nconst binarySearch = (a: number[], y: number): number => {\n  let l = 0;\n  let h = a.length - 1;\n\n  while (l <= h) {\n    const m = (l + h) >>> 1;\n    const x = a[m];\n    if (x === y) return m;\n    else if (x <= y) l = m + 1;\n    else h = m - 1;\n  }\n\n  return -1;\n};\n\nconst getColumns = (\n  width = 0,\n  minimumWidth = 0,\n  gutter = 8,\n  columnCount?: number\n): [number, number] => {\n  columnCount = columnCount || Math.floor(width / (minimumWidth + gutter)) || 1;\n  const columnWidth = Math.floor(\n    (width - gutter * (columnCount - 1)) / columnCount\n  );\n  return [columnWidth, columnCount];\n};\n\nconst emptyArr: [] = [];\n","var resizeObservers = [];\nexport { resizeObservers };\n","import { resizeObservers } from '../utils/resizeObservers';\nvar hasActiveObservations = function () {\n    return resizeObservers.some(function (ro) { return ro.activeTargets.length > 0; });\n};\nexport { hasActiveObservations };\n","import { resizeObservers } from '../utils/resizeObservers';\nvar hasSkippedObservations = function () {\n    return resizeObservers.some(function (ro) { return ro.skippedTargets.length > 0; });\n};\nexport { hasSkippedObservations };\n","var msg = 'ResizeObserver loop completed with undelivered notifications.';\nvar deliverResizeLoopError = function () {\n    var event;\n    if (typeof ErrorEvent === 'function') {\n        event = new ErrorEvent('error', {\n            message: msg\n        });\n    }\n    else {\n        event = document.createEvent('Event');\n        event.initEvent('error', false, false);\n        event.message = msg;\n    }\n    window.dispatchEvent(event);\n};\nexport { deliverResizeLoopError };\n","var ResizeObserverBoxOptions;\n(function (ResizeObserverBoxOptions) {\n    ResizeObserverBoxOptions[\"BORDER_BOX\"] = \"border-box\";\n    ResizeObserverBoxOptions[\"CONTENT_BOX\"] = \"content-box\";\n    ResizeObserverBoxOptions[\"DEVICE_PIXEL_CONTENT_BOX\"] = \"device-pixel-content-box\";\n})(ResizeObserverBoxOptions || (ResizeObserverBoxOptions = {}));\nexport { ResizeObserverBoxOptions };\n","export var freeze = function (obj) { return Object.freeze(obj); };\n","import { freeze } from './utils/freeze';\nvar ResizeObserverSize = (function () {\n    function ResizeObserverSize(inlineSize, blockSize) {\n        this.inlineSize = inlineSize;\n        this.blockSize = blockSize;\n        freeze(this);\n    }\n    return ResizeObserverSize;\n}());\nexport { ResizeObserverSize };\n","import { freeze } from './utils/freeze';\nvar DOMRectReadOnly = (function () {\n    function DOMRectReadOnly(x, y, width, height) {\n        this.x = x;\n        this.y = y;\n        this.width = width;\n        this.height = height;\n        this.top = this.y;\n        this.left = this.x;\n        this.bottom = this.top + this.height;\n        this.right = this.left + this.width;\n        return freeze(this);\n    }\n    DOMRectReadOnly.prototype.toJSON = function () {\n        var _a = this, x = _a.x, y = _a.y, top = _a.top, right = _a.right, bottom = _a.bottom, left = _a.left, width = _a.width, height = _a.height;\n        return { x: x, y: y, top: top, right: right, bottom: bottom, left: left, width: width, height: height };\n    };\n    DOMRectReadOnly.fromRect = function (rectangle) {\n        return new DOMRectReadOnly(rectangle.x, rectangle.y, rectangle.width, rectangle.height);\n    };\n    return DOMRectReadOnly;\n}());\nexport { DOMRectReadOnly };\n","var isSVG = function (target) { return target instanceof SVGElement && 'getBBox' in target; };\nvar isHidden = function (target) {\n    if (isSVG(target)) {\n        var _a = target.getBBox(), width = _a.width, height = _a.height;\n        return !width && !height;\n    }\n    var _b = target, offsetWidth = _b.offsetWidth, offsetHeight = _b.offsetHeight;\n    return !(offsetWidth || offsetHeight || target.getClientRects().length);\n};\nvar isElement = function (obj) {\n    var _a, _b;\n    if (obj instanceof Element) {\n        return true;\n    }\n    var scope = (_b = (_a = obj) === null || _a === void 0 ? void 0 : _a.ownerDocument) === null || _b === void 0 ? void 0 : _b.defaultView;\n    return !!(scope && obj instanceof scope.Element);\n};\nvar isReplacedElement = function (target) {\n    switch (target.tagName) {\n        case 'INPUT':\n            if (target.type !== 'image') {\n                break;\n            }\n        case 'VIDEO':\n        case 'AUDIO':\n        case 'EMBED':\n        case 'OBJECT':\n        case 'CANVAS':\n        case 'IFRAME':\n        case 'IMG':\n            return true;\n    }\n    return false;\n};\nexport { isSVG, isHidden, isElement, isReplacedElement };\n","export var global = typeof window !== 'undefined' ? window : {};\n","import { ResizeObserverBoxOptions } from '../ResizeObserverBoxOptions';\nimport { ResizeObserverSize } from '../ResizeObserverSize';\nimport { DOMRectReadOnly } from '../DOMRectReadOnly';\nimport { isSVG, isHidden } from '../utils/element';\nimport { freeze } from '../utils/freeze';\nimport { global } from '../utils/global';\nvar cache = new WeakMap();\nvar scrollRegexp = /auto|scroll/;\nvar verticalRegexp = /^tb|vertical/;\nvar IE = (/msie|trident/i).test(global.navigator && global.navigator.userAgent);\nvar parseDimension = function (pixel) { return parseFloat(pixel || '0'); };\nvar size = function (inlineSize, blockSize, switchSizes) {\n    if (inlineSize === void 0) { inlineSize = 0; }\n    if (blockSize === void 0) { blockSize = 0; }\n    if (switchSizes === void 0) { switchSizes = false; }\n    return new ResizeObserverSize((switchSizes ? blockSize : inlineSize) || 0, (switchSizes ? inlineSize : blockSize) || 0);\n};\nvar zeroBoxes = freeze({\n    devicePixelContentBoxSize: size(),\n    borderBoxSize: size(),\n    contentBoxSize: size(),\n    contentRect: new DOMRectReadOnly(0, 0, 0, 0)\n});\nvar calculateBoxSizes = function (target, forceRecalculation) {\n    if (forceRecalculation === void 0) { forceRecalculation = false; }\n    if (cache.has(target) && !forceRecalculation) {\n        return cache.get(target);\n    }\n    if (isHidden(target)) {\n        cache.set(target, zeroBoxes);\n        return zeroBoxes;\n    }\n    var cs = getComputedStyle(target);\n    var svg = isSVG(target) && target.ownerSVGElement && target.getBBox();\n    var removePadding = !IE && cs.boxSizing === 'border-box';\n    var switchSizes = verticalRegexp.test(cs.writingMode || '');\n    var canScrollVertically = !svg && scrollRegexp.test(cs.overflowY || '');\n    var canScrollHorizontally = !svg && scrollRegexp.test(cs.overflowX || '');\n    var paddingTop = svg ? 0 : parseDimension(cs.paddingTop);\n    var paddingRight = svg ? 0 : parseDimension(cs.paddingRight);\n    var paddingBottom = svg ? 0 : parseDimension(cs.paddingBottom);\n    var paddingLeft = svg ? 0 : parseDimension(cs.paddingLeft);\n    var borderTop = svg ? 0 : parseDimension(cs.borderTopWidth);\n    var borderRight = svg ? 0 : parseDimension(cs.borderRightWidth);\n    var borderBottom = svg ? 0 : parseDimension(cs.borderBottomWidth);\n    var borderLeft = svg ? 0 : parseDimension(cs.borderLeftWidth);\n    var horizontalPadding = paddingLeft + paddingRight;\n    var verticalPadding = paddingTop + paddingBottom;\n    var horizontalBorderArea = borderLeft + borderRight;\n    var verticalBorderArea = borderTop + borderBottom;\n    var horizontalScrollbarThickness = !canScrollHorizontally ? 0 : target.offsetHeight - verticalBorderArea - target.clientHeight;\n    var verticalScrollbarThickness = !canScrollVertically ? 0 : target.offsetWidth - horizontalBorderArea - target.clientWidth;\n    var widthReduction = removePadding ? horizontalPadding + horizontalBorderArea : 0;\n    var heightReduction = removePadding ? verticalPadding + verticalBorderArea : 0;\n    var contentWidth = svg ? svg.width : parseDimension(cs.width) - widthReduction - verticalScrollbarThickness;\n    var contentHeight = svg ? svg.height : parseDimension(cs.height) - heightReduction - horizontalScrollbarThickness;\n    var borderBoxWidth = contentWidth + horizontalPadding + verticalScrollbarThickness + horizontalBorderArea;\n    var borderBoxHeight = contentHeight + verticalPadding + horizontalScrollbarThickness + verticalBorderArea;\n    var boxes = freeze({\n        devicePixelContentBoxSize: size(Math.round(contentWidth * devicePixelRatio), Math.round(contentHeight * devicePixelRatio), switchSizes),\n        borderBoxSize: size(borderBoxWidth, borderBoxHeight, switchSizes),\n        contentBoxSize: size(contentWidth, contentHeight, switchSizes),\n        contentRect: new DOMRectReadOnly(paddingLeft, paddingTop, contentWidth, contentHeight)\n    });\n    cache.set(target, boxes);\n    return boxes;\n};\nvar calculateBoxSize = function (target, observedBox, forceRecalculation) {\n    var _a = calculateBoxSizes(target, forceRecalculation), borderBoxSize = _a.borderBoxSize, contentBoxSize = _a.contentBoxSize, devicePixelContentBoxSize = _a.devicePixelContentBoxSize;\n    switch (observedBox) {\n        case ResizeObserverBoxOptions.DEVICE_PIXEL_CONTENT_BOX:\n            return devicePixelContentBoxSize;\n        case ResizeObserverBoxOptions.BORDER_BOX:\n            return borderBoxSize;\n        default:\n            return contentBoxSize;\n    }\n};\nexport { calculateBoxSize, calculateBoxSizes };\n","import { calculateBoxSizes } from './algorithms/calculateBoxSize';\nimport { freeze } from './utils/freeze';\nvar ResizeObserverEntry = (function () {\n    function ResizeObserverEntry(target) {\n        var boxes = calculateBoxSizes(target);\n        this.target = target;\n        this.contentRect = boxes.contentRect;\n        this.borderBoxSize = freeze([boxes.borderBoxSize]);\n        this.contentBoxSize = freeze([boxes.contentBoxSize]);\n        this.devicePixelContentBoxSize = freeze([boxes.devicePixelContentBoxSize]);\n    }\n    return ResizeObserverEntry;\n}());\nexport { ResizeObserverEntry };\n","import { isHidden } from '../utils/element';\nvar calculateDepthForNode = function (node) {\n    if (isHidden(node)) {\n        return Infinity;\n    }\n    var depth = 0;\n    var parent = node.parentNode;\n    while (parent) {\n        depth += 1;\n        parent = parent.parentNode;\n    }\n    return depth;\n};\nexport { calculateDepthForNode };\n","import { resizeObservers } from '../utils/resizeObservers';\nimport { ResizeObserverEntry } from '../ResizeObserverEntry';\nimport { calculateDepthForNode } from './calculateDepthForNode';\nimport { calculateBoxSize } from './calculateBoxSize';\nvar broadcastActiveObservations = function () {\n    var shallowestDepth = Infinity;\n    var callbacks = [];\n    resizeObservers.forEach(function processObserver(ro) {\n        if (ro.activeTargets.length === 0) {\n            return;\n        }\n        var entries = [];\n        ro.activeTargets.forEach(function processTarget(ot) {\n            var entry = new ResizeObserverEntry(ot.target);\n            var targetDepth = calculateDepthForNode(ot.target);\n            entries.push(entry);\n            ot.lastReportedSize = calculateBoxSize(ot.target, ot.observedBox);\n            if (targetDepth < shallowestDepth) {\n                shallowestDepth = targetDepth;\n            }\n        });\n        callbacks.push(function resizeObserverCallback() {\n            ro.callback.call(ro.observer, entries, ro.observer);\n        });\n        ro.activeTargets.splice(0, ro.activeTargets.length);\n    });\n    for (var _i = 0, callbacks_1 = callbacks; _i < callbacks_1.length; _i++) {\n        var callback = callbacks_1[_i];\n        callback();\n    }\n    return shallowestDepth;\n};\nexport { broadcastActiveObservations };\n","import { resizeObservers } from '../utils/resizeObservers';\nimport { calculateDepthForNode } from './calculateDepthForNode';\nvar gatherActiveObservationsAtDepth = function (depth) {\n    resizeObservers.forEach(function processObserver(ro) {\n        ro.activeTargets.splice(0, ro.activeTargets.length);\n        ro.skippedTargets.splice(0, ro.skippedTargets.length);\n        ro.observationTargets.forEach(function processTarget(ot) {\n            if (ot.isActive()) {\n                if (calculateDepthForNode(ot.target) > depth) {\n                    ro.activeTargets.push(ot);\n                }\n                else {\n                    ro.skippedTargets.push(ot);\n                }\n            }\n        });\n    });\n};\nexport { gatherActiveObservationsAtDepth };\n","import { hasActiveObservations } from '../algorithms/hasActiveObservations';\nimport { hasSkippedObservations } from '../algorithms/hasSkippedObservations';\nimport { deliverResizeLoopError } from '../algorithms/deliverResizeLoopError';\nimport { broadcastActiveObservations } from '../algorithms/broadcastActiveObservations';\nimport { gatherActiveObservationsAtDepth } from '../algorithms/gatherActiveObservationsAtDepth';\nvar process = function () {\n    var depth = 0;\n    gatherActiveObservationsAtDepth(depth);\n    while (hasActiveObservations()) {\n        depth = broadcastActiveObservations();\n        gatherActiveObservationsAtDepth(depth);\n    }\n    if (hasSkippedObservations()) {\n        deliverResizeLoopError();\n    }\n    return depth > 0;\n};\nexport { process };\n","var trigger;\nvar callbacks = [];\nvar notify = function () { return callbacks.splice(0).forEach(function (cb) { return cb(); }); };\nvar queueMicroTask = function (callback) {\n    if (!trigger) {\n        var toggle_1 = 0;\n        var el_1 = document.createTextNode('');\n        var config = { characterData: true };\n        new MutationObserver(function () { return notify(); }).observe(el_1, config);\n        trigger = function () { el_1.textContent = \"\" + (toggle_1 ? toggle_1-- : toggle_1++); };\n    }\n    callbacks.push(callback);\n    trigger();\n};\nexport { queueMicroTask };\n","import { queueMicroTask } from './queueMicroTask';\nvar queueResizeObserver = function (cb) {\n    queueMicroTask(function ResizeObserver() {\n        requestAnimationFrame(cb);\n    });\n};\nexport { queueResizeObserver };\n","import { process } from './process';\nimport { global } from './global';\nimport { queueResizeObserver } from './queueResizeObserver';\nvar watching = 0;\nvar isWatching = function () { return !!watching; };\nvar CATCH_PERIOD = 250;\nvar observerConfig = { attributes: true, characterData: true, childList: true, subtree: true };\nvar events = [\n    'resize',\n    'load',\n    'transitionend',\n    'animationend',\n    'animationstart',\n    'animationiteration',\n    'keyup',\n    'keydown',\n    'mouseup',\n    'mousedown',\n    'mouseover',\n    'mouseout',\n    'blur',\n    'focus'\n];\nvar time = function (timeout) {\n    if (timeout === void 0) { timeout = 0; }\n    return Date.now() + timeout;\n};\nvar scheduled = false;\nvar Scheduler = (function () {\n    function Scheduler() {\n        var _this = this;\n        this.stopped = true;\n        this.listener = function () { return _this.schedule(); };\n    }\n    Scheduler.prototype.run = function (timeout) {\n        var _this = this;\n        if (timeout === void 0) { timeout = CATCH_PERIOD; }\n        if (scheduled) {\n            return;\n        }\n        scheduled = true;\n        var until = time(timeout);\n        queueResizeObserver(function () {\n            var elementsHaveResized = false;\n            try {\n                elementsHaveResized = process();\n            }\n            finally {\n                scheduled = false;\n                timeout = until - time();\n                if (!isWatching()) {\n                    return;\n                }\n                if (elementsHaveResized) {\n                    _this.run(1000);\n                }\n                else if (timeout > 0) {\n                    _this.run(timeout);\n                }\n                else {\n                    _this.start();\n                }\n            }\n        });\n    };\n    Scheduler.prototype.schedule = function () {\n        this.stop();\n        this.run();\n    };\n    Scheduler.prototype.observe = function () {\n        var _this = this;\n        var cb = function () { return _this.observer && _this.observer.observe(document.body, observerConfig); };\n        document.body ? cb() : global.addEventListener('DOMContentLoaded', cb);\n    };\n    Scheduler.prototype.start = function () {\n        var _this = this;\n        if (this.stopped) {\n            this.stopped = false;\n            this.observer = new MutationObserver(this.listener);\n            this.observe();\n            events.forEach(function (name) { return global.addEventListener(name, _this.listener, true); });\n        }\n    };\n    Scheduler.prototype.stop = function () {\n        var _this = this;\n        if (!this.stopped) {\n            this.observer && this.observer.disconnect();\n            events.forEach(function (name) { return global.removeEventListener(name, _this.listener, true); });\n            this.stopped = true;\n        }\n    };\n    return Scheduler;\n}());\nvar scheduler = new Scheduler();\nvar updateCount = function (n) {\n    !watching && n > 0 && scheduler.start();\n    watching += n;\n    !watching && scheduler.stop();\n};\nexport { scheduler, updateCount };\n","import { ResizeObserverBoxOptions } from './ResizeObserverBoxOptions';\nimport { calculateBoxSize } from './algorithms/calculateBoxSize';\nimport { isSVG, isReplacedElement } from './utils/element';\nvar skipNotifyOnElement = function (target) {\n    return !isSVG(target)\n        && !isReplacedElement(target)\n        && getComputedStyle(target).display === 'inline';\n};\nvar ResizeObservation = (function () {\n    function ResizeObservation(target, observedBox) {\n        this.target = target;\n        this.observedBox = observedBox || ResizeObserverBoxOptions.CONTENT_BOX;\n        this.lastReportedSize = {\n            inlineSize: 0,\n            blockSize: 0\n        };\n    }\n    ResizeObservation.prototype.isActive = function () {\n        var size = calculateBoxSize(this.target, this.observedBox, true);\n        if (skipNotifyOnElement(this.target)) {\n            this.lastReportedSize = size;\n        }\n        if (this.lastReportedSize.inlineSize !== size.inlineSize\n            || this.lastReportedSize.blockSize !== size.blockSize) {\n            return true;\n        }\n        return false;\n    };\n    return ResizeObservation;\n}());\nexport { ResizeObservation };\n","var ResizeObserverDetail = (function () {\n    function ResizeObserverDetail(resizeObserver, callback) {\n        this.activeTargets = [];\n        this.skippedTargets = [];\n        this.observationTargets = [];\n        this.observer = resizeObserver;\n        this.callback = callback;\n    }\n    return ResizeObserverDetail;\n}());\nexport { ResizeObserverDetail };\n","import { scheduler, updateCount } from './utils/scheduler';\nimport { ResizeObservation } from './ResizeObservation';\nimport { ResizeObserverDetail } from './ResizeObserverDetail';\nimport { resizeObservers } from './utils/resizeObservers';\nvar observerMap = new WeakMap();\nvar getObservationIndex = function (observationTargets, target) {\n    for (var i = 0; i < observationTargets.length; i += 1) {\n        if (observationTargets[i].target === target) {\n            return i;\n        }\n    }\n    return -1;\n};\nvar ResizeObserverController = (function () {\n    function ResizeObserverController() {\n    }\n    ResizeObserverController.connect = function (resizeObserver, callback) {\n        var detail = new ResizeObserverDetail(resizeObserver, callback);\n        observerMap.set(resizeObserver, detail);\n    };\n    ResizeObserverController.observe = function (resizeObserver, target, options) {\n        var detail = observerMap.get(resizeObserver);\n        var firstObservation = detail.observationTargets.length === 0;\n        if (getObservationIndex(detail.observationTargets, target) < 0) {\n            firstObservation && resizeObservers.push(detail);\n            detail.observationTargets.push(new ResizeObservation(target, options && options.box));\n            updateCount(1);\n            scheduler.schedule();\n        }\n    };\n    ResizeObserverController.unobserve = function (resizeObserver, target) {\n        var detail = observerMap.get(resizeObserver);\n        var index = getObservationIndex(detail.observationTargets, target);\n        var lastObservation = detail.observationTargets.length === 1;\n        if (index >= 0) {\n            lastObservation && resizeObservers.splice(resizeObservers.indexOf(detail), 1);\n            detail.observationTargets.splice(index, 1);\n            updateCount(-1);\n        }\n    };\n    ResizeObserverController.disconnect = function (resizeObserver) {\n        var _this = this;\n        var detail = observerMap.get(resizeObserver);\n        detail.observationTargets.slice().forEach(function (ot) { return _this.unobserve(resizeObserver, ot.target); });\n        detail.activeTargets.splice(0, detail.activeTargets.length);\n    };\n    return ResizeObserverController;\n}());\nexport { ResizeObserverController };\n","import { ResizeObserverController } from './ResizeObserverController';\nimport { isElement } from './utils/element';\nvar ResizeObserver = (function () {\n    function ResizeObserver(callback) {\n        if (arguments.length === 0) {\n            throw new TypeError(\"Failed to construct 'ResizeObserver': 1 argument required, but only 0 present.\");\n        }\n        if (typeof callback !== 'function') {\n            throw new TypeError(\"Failed to construct 'ResizeObserver': The callback provided as parameter 1 is not a function.\");\n        }\n        ResizeObserverController.connect(this, callback);\n    }\n    ResizeObserver.prototype.observe = function (target, options) {\n        if (arguments.length === 0) {\n            throw new TypeError(\"Failed to execute 'observe' on 'ResizeObserver': 1 argument required, but only 0 present.\");\n        }\n        if (!isElement(target)) {\n            throw new TypeError(\"Failed to execute 'observe' on 'ResizeObserver': parameter 1 is not of type 'Element\");\n        }\n        ResizeObserverController.observe(this, target, options);\n    };\n    ResizeObserver.prototype.unobserve = function (target) {\n        if (arguments.length === 0) {\n            throw new TypeError(\"Failed to execute 'unobserve' on 'ResizeObserver': 1 argument required, but only 0 present.\");\n        }\n        if (!isElement(target)) {\n            throw new TypeError(\"Failed to execute 'unobserve' on 'ResizeObserver': parameter 1 is not of type 'Element\");\n        }\n        ResizeObserverController.unobserve(this, target);\n    };\n    ResizeObserver.prototype.disconnect = function () {\n        ResizeObserverController.disconnect(this);\n    };\n    ResizeObserver.toString = function () {\n        return 'function ResizeObserver () { [polyfill code] }';\n    };\n    return ResizeObserver;\n}());\nexport { ResizeObserver };\n","var rafSchd = function rafSchd(fn) {\n  var lastArgs = [];\n  var frameId = null;\n\n  var wrapperFn = function wrapperFn() {\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    lastArgs = args;\n\n    if (frameId) {\n      return;\n    }\n\n    frameId = requestAnimationFrame(function () {\n      frameId = null;\n      fn.apply(void 0, lastArgs);\n    });\n  };\n\n  wrapperFn.cancel = function () {\n    if (!frameId) {\n      return;\n    }\n\n    cancelAnimationFrame(frameId);\n    frameId = null;\n  };\n\n  return wrapperFn;\n};\n\nexport default rafSchd;\n","import { ResizeObserver as Polyfill } from \"@juggle/resize-observer\";\nimport rafSchd from \"raf-schd\";\nimport * as React from \"react\";\nimport trieMemoize from \"trie-memoize\";\nimport { elementsCache } from \"./elements-cache\";\nimport { useForceUpdate } from \"./use-force-update\";\nimport type { Positioner } from \"./use-positioner\";\n\nconst ResizeObserver =\n  typeof window !== \"undefined\" && \"ResizeObserver\" in window\n    ? window.ResizeObserver\n    : Polyfill;\n\n/**\n * Creates a resize observer that forces updates to the grid cell positions when mutations are\n * made to cells affecting their height.\n *\n * @param positioner - The masonry cell positioner created by the `usePositioner()` hook.\n */\nexport function useResizeObserver(positioner: Positioner) {\n  const forceUpdate = useForceUpdate();\n  const resizeObserver = createResizeObserver(positioner, forceUpdate);\n  // Cleans up the resize observers when they change or the\n  // component unmounts\n  React.useEffect(() => () => resizeObserver.disconnect(), [resizeObserver]);\n  return resizeObserver;\n}\n\n/**\n * Creates a resize observer that fires an `updater` callback whenever the height of\n * one or many cells change. The `useResizeObserver()` hook is using this under the hood.\n *\n * @param positioner - A cell positioner created by the `usePositioner()` hook or the `createPositioner()` utility\n * @param updater - A callback that fires whenever one or many cell heights change.\n */\nexport const createResizeObserver = trieMemoize(\n  [WeakMap],\n  // TODO: figure out a way to test this\n  /* istanbul ignore next */\n  (positioner: Positioner, updater: (updates: number[]) => void) => {\n    const handleEntries = rafSchd(((entries) => {\n      const updates: number[] = [];\n      let i = 0;\n\n      for (; i < entries.length; i++) {\n        const entry = entries[i];\n        const height = (entry.target as HTMLElement).offsetHeight;\n\n        if (height > 0) {\n          const index = elementsCache.get(entry.target);\n\n          if (index !== void 0) {\n            const position = positioner.get(index);\n\n            if (position !== void 0 && height !== position.height)\n              updates.push(index, height);\n          }\n        }\n      }\n\n      if (updates.length > 0) {\n        // Updates the size/positions of the cell with the resize\n        // observer updates\n        positioner.update(updates);\n        updater(updates);\n      }\n    }) as ResizeObserverCallback);\n\n    const ro = new ResizeObserver(handleEntries);\n    // Overrides the original disconnect to include cancelling handling the entries.\n    // Ideally this would be its own method but that would result in a breaking\n    // change.\n    const disconnect = ro.disconnect.bind(ro);\n    ro.disconnect = () => {\n      disconnect();\n      handleEntries.cancel();\n    };\n\n    return ro;\n  }\n);\n","import useEvent from \"@react-hook/event\";\nimport useLatest from \"@react-hook/latest\";\nimport { useThrottleCallback } from \"@react-hook/throttle\";\nimport * as React from \"react\";\nimport type { Positioner, PositionerItem } from \"./use-positioner\";\n\n/**\n * A hook that creates a callback for scrolling to a specific index in\n * the \"items\" array.\n *\n * @param positioner - A positioner created by the `usePositioner()` hook\n * @param options - Configuration options\n */\nexport function useScrollToIndex(\n  positioner: Positioner,\n  options: UseScrollToIndexOptions\n) {\n  const {\n    align = \"top\",\n    element = typeof window !== \"undefined\" && window,\n    offset = 0,\n    height = typeof window !== \"undefined\" ? window.innerHeight : 0,\n  } = options;\n  const latestOptions = useLatest({\n    positioner,\n    element,\n    align,\n    offset,\n    height,\n  } as const);\n  const getTarget = React.useRef(() => {\n    const latestElement = latestOptions.current.element;\n    return latestElement && \"current\" in latestElement\n      ? latestElement.current\n      : latestElement;\n  }).current;\n  const [state, dispatch] = React.useReducer(\n    (\n      state: {\n        position: PositionerItem | undefined;\n        index: number | undefined;\n        prevTop: number | undefined;\n      },\n      action:\n        | { type: \"scrollToIndex\"; value: number | undefined }\n        | { type: \"setPosition\"; value: PositionerItem | undefined }\n        | { type: \"setPrevTop\"; value: number | undefined }\n        | { type: \"reset\" }\n    ) => {\n      const nextState = {\n        position: state.position,\n        index: state.index,\n        prevTop: state.prevTop,\n      };\n\n      /* istanbul ignore next */\n      if (action.type === \"scrollToIndex\") {\n        return {\n          position: latestOptions.current.positioner.get(action.value ?? -1),\n          index: action.value,\n          prevTop: void 0,\n        };\n      } else if (action.type === \"setPosition\") {\n        nextState.position = action.value;\n      } else if (action.type === \"setPrevTop\") {\n        nextState.prevTop = action.value;\n      } else if (action.type === \"reset\") {\n        return defaultState;\n      }\n\n      return nextState;\n    },\n    defaultState\n  );\n  const throttledDispatch = useThrottleCallback(dispatch, 15);\n\n  // If we find the position along the way we can immediately take off\n  // to the correct spot.\n  useEvent(getTarget() as Window, \"scroll\", () => {\n    if (!state.position && state.index) {\n      const position = latestOptions.current.positioner.get(state.index);\n\n      if (position) {\n        dispatch({ type: \"setPosition\", value: position });\n      }\n    }\n  });\n\n  // If the top changes out from under us in the case of dynamic cells, we\n  // want to keep following it.\n  const currentTop =\n    state.index !== void 0 &&\n    latestOptions.current.positioner.get(state.index)?.top;\n\n  React.useEffect(() => {\n    const target = getTarget();\n    if (!target) return;\n    const { height, align, offset, positioner } = latestOptions.current;\n\n    if (state.position) {\n      let scrollTop = state.position.top;\n\n      if (align === \"bottom\") {\n        scrollTop = scrollTop - height + state.position.height;\n      } else if (align === \"center\") {\n        scrollTop -= (height - state.position.height) / 2;\n      }\n\n      target.scrollTo(0, Math.max(0, (scrollTop += offset)));\n      // Resets state after 400ms, an arbitrary time I determined to be\n      // still visually pleasing if there is a slow network reply in dynamic\n      // cells\n      let didUnsubscribe = false;\n      const timeout = setTimeout(\n        () => !didUnsubscribe && dispatch({ type: \"reset\" }),\n        400\n      );\n      return () => {\n        didUnsubscribe = true;\n        clearTimeout(timeout);\n      };\n    } else if (state.index !== void 0) {\n      // Estimates the top based upon the average height of current cells\n      let estimatedTop =\n        (positioner.shortestColumn() / positioner.size()) * state.index;\n      if (state.prevTop)\n        estimatedTop = Math.max(estimatedTop, state.prevTop + height);\n      target.scrollTo(0, estimatedTop);\n      throttledDispatch({ type: \"setPrevTop\", value: estimatedTop });\n    }\n  }, [currentTop, state, latestOptions, getTarget, throttledDispatch]);\n\n  return React.useRef((index: number) => {\n    dispatch({ type: \"scrollToIndex\", value: index });\n  }).current;\n}\n\nconst defaultState = {\n  index: void 0,\n  position: void 0,\n  prevTop: void 0,\n} as const;\n\nexport type UseScrollToIndexOptions = {\n  /**\n   * The window element or a React ref for the window element. That is,\n   * this is the grid container.\n   *\n   * @default window\n   */\n  element?: Window | HTMLElement | React.RefObject<HTMLElement> | null;\n  /**\n   * Sets the vertical alignment of the cell within the grid container.\n   *\n   * @default \"top\"\n   */\n  align?: \"center\" | \"top\" | \"bottom\";\n  /**\n   * The height of the grid.\n   *\n   * @default window.innerHeight\n   */\n  height?: number;\n  /**\n   * The vertical space in pixels between the top of the grid container and the top\n   * of the window.\n   *\n   * @default 0\n   */\n  offset?: number;\n};\n","import { useWindowSize } from \"@react-hook/window-size\";\nimport * as React from \"react\";\nimport { MasonryScroller } from \"./masonry-scroller\";\nimport type { MasonryScrollerProps } from \"./masonry-scroller\";\nimport { useContainerPosition } from \"./use-container-position\";\nimport { usePositioner } from \"./use-positioner\";\nimport type { UsePositionerOptions } from \"./use-positioner\";\nimport { useResizeObserver } from \"./use-resize-observer\";\nimport { useScrollToIndex } from \"./use-scroll-to-index\";\nimport type { UseScrollToIndexOptions } from \"./use-scroll-to-index\";\n\n/**\n * A \"batteries included\" masonry grid which includes all of the implementation details below. This component is the\n * easiest way to get off and running in your app, before switching to more advanced implementations, if necessary.\n * It will change its column count to fit its container's width and will decide how many rows to render based upon\n * the height of the browser `window`.\n *\n * @param props\n */\nexport function Masonry<Item>(props: MasonryProps<Item>) {\n  const containerRef = React.useRef<null | HTMLElement>(null);\n  const windowSize = useWindowSize({\n    initialWidth: props.ssrWidth,\n    initialHeight: props.ssrHeight,\n  });\n  const containerPos = useContainerPosition(containerRef, windowSize);\n  const nextProps = Object.assign(\n    {\n      offset: containerPos.offset,\n      width: containerPos.width || windowSize[0],\n      height: windowSize[1],\n      containerRef,\n    },\n    props\n  ) as any;\n  nextProps.positioner = usePositioner(nextProps);\n  nextProps.resizeObserver = useResizeObserver(nextProps.positioner);\n  const scrollToIndex = useScrollToIndex(nextProps.positioner, {\n    height: nextProps.height,\n    offset: containerPos.offset,\n    align:\n      typeof props.scrollToIndex === \"object\"\n        ? props.scrollToIndex.align\n        : void 0,\n  });\n  const index =\n    props.scrollToIndex &&\n    (typeof props.scrollToIndex === \"number\"\n      ? props.scrollToIndex\n      : props.scrollToIndex.index);\n\n  React.useEffect(() => {\n    if (index !== void 0) scrollToIndex(index);\n  }, [index, scrollToIndex]);\n\n  return React.createElement(MasonryScroller, nextProps);\n}\n\nexport interface MasonryProps<Item>\n  extends Omit<\n      MasonryScrollerProps<Item>,\n      \"offset\" | \"width\" | \"height\" | \"containerRef\" | \"positioner\"\n    >,\n    Pick<\n      UsePositionerOptions,\n      \"columnWidth\" | \"columnGutter\" | \"rowGutter\" | \"columnCount\"\n    > {\n  /**\n   * Scrolls to a given index within the grid. The grid will re-scroll\n   * any time the index changes.\n   */\n  scrollToIndex?:\n    | number\n    | {\n        index: number;\n        align: UseScrollToIndexOptions[\"align\"];\n      };\n  /**\n   * This is the width that will be used for the browser `window` when rendering this component in SSR.\n   * This prop isn't relevant for client-side only apps.\n   */\n  ssrWidth?: number;\n  /**\n   * This is the height that will be used for the browser `window` when rendering this component in SSR.\n   * This prop isn't relevant for client-side only apps.\n   */\n  ssrHeight?: number;\n  /**\n   * This determines how often (in frames per second) to update the scroll position of the\n   * browser `window` in state, and as a result the rate the masonry grid recalculates its visible cells.\n   * The default value of `12` has been very reasonable in my own testing, but if you have particularly\n   * heavy `render` components it may be prudent to reduce this number.\n   *\n   * @default 12\n   */\n  scrollFps?: number;\n}\n\nif (typeof process !== \"undefined\" && process.env.NODE_ENV !== \"production\") {\n  Masonry.displayName = \"Masonry\";\n}\n","import * as React from \"react\";\nimport { Masonry } from \"./masonry\";\nimport type { MasonryProps } from \"./masonry\";\n\n/**\n * This is just a single-column `<Masonry>` component without column-specific props.\n *\n * @param props\n */\nexport function List<Item>(props: ListProps<Item>) {\n  return (\n    <Masonry<Item>\n      role=\"list\"\n      rowGutter={props.rowGutter}\n      columnCount={1}\n      columnWidth={1}\n      {...props}\n    />\n  );\n}\n\nexport interface ListProps<Item>\n  extends Omit<\n    MasonryProps<Item>,\n    \"columGutter\" | \"columnCount\" | \"columnWidth\"\n  > {\n  /**\n   * The amount of vertical space in pixels to add between the list cells.\n   *\n   * @default 0\n   */\n  rowGutter?: number;\n}\n\nif (typeof process !== \"undefined\" && process.env.NODE_ENV !== \"production\") {\n  List.displayName = \"List\";\n}\n","import useLatest from \"@react-hook/latest\";\nimport * as React from \"react\";\n\n/**\n * A utility hook for seamlessly adding infinite scroll behavior to the `useMasonry()` hook. This\n * hook invokes a callback each time the last rendered index surpasses the total number of items\n * in your items array or the number defined in the `totalItems` option.\n *\n * @param loadMoreItems - This callback is invoked when more rows must be loaded. It will be used to\n *  determine when to refresh the list with the newly-loaded data. This callback may be called multiple\n *  times in reaction to a single scroll event, so it's important to memoize its arguments. If you're\n *  creating this callback inside of a functional component, make sure you wrap it in `React.useCallback()`,\n *  as well.\n * @param options\n */\nexport function useInfiniteLoader<Item, T extends LoadMoreItemsCallback<Item>>(\n  loadMoreItems: T,\n  options: UseInfiniteLoaderOptions<Item> = emptyObj\n): LoadMoreItemsCallback<Item> {\n  const {\n    isItemLoaded,\n    minimumBatchSize = 16,\n    threshold = 16,\n    totalItems = 9e9,\n  } = options;\n  const storedLoadMoreItems = useLatest(loadMoreItems);\n  const storedIsItemLoaded = useLatest(isItemLoaded);\n\n  return React.useCallback(\n    (startIndex, stopIndex, items) => {\n      const unloadedRanges = scanForUnloadedRanges(\n        storedIsItemLoaded.current,\n        minimumBatchSize,\n        items,\n        totalItems,\n        Math.max(0, startIndex - threshold),\n        Math.min(totalItems - 1, (stopIndex || 0) + threshold)\n      );\n      // The user is responsible for memoizing their loadMoreItems() function\n      // because we don't want to make assumptions about how they want to deal\n      // with `items`\n      for (let i = 0; i < unloadedRanges.length - 1; ++i)\n        storedLoadMoreItems.current(\n          unloadedRanges[i],\n          unloadedRanges[++i],\n          items\n        );\n    },\n    [\n      totalItems,\n      minimumBatchSize,\n      threshold,\n      storedLoadMoreItems,\n      storedIsItemLoaded,\n    ]\n  );\n}\n\n/**\n * Returns all of the ranges within a larger range that contain unloaded rows.\n *\n * @param isItemLoaded\n * @param minimumBatchSize\n * @param items\n * @param totalItems\n * @param startIndex\n * @param stopIndex\n */\nfunction scanForUnloadedRanges<Item>(\n  isItemLoaded: UseInfiniteLoaderOptions<Item>[\"isItemLoaded\"] = defaultIsItemLoaded,\n  minimumBatchSize: UseInfiniteLoaderOptions<Item>[\"minimumBatchSize\"] = 16,\n  items: any[],\n  totalItems: UseInfiniteLoaderOptions<Item>[\"totalItems\"] = 9e9,\n  startIndex: number,\n  stopIndex: number\n): number[] {\n  const unloadedRanges: number[] = [];\n  let rangeStartIndex: number | undefined,\n    rangeStopIndex: number | undefined,\n    index = startIndex;\n\n  /* istanbul ignore next */\n  for (; index <= stopIndex; index++) {\n    if (!isItemLoaded(index, items)) {\n      rangeStopIndex = index;\n      if (rangeStartIndex === void 0) rangeStartIndex = index;\n    } else if (rangeStartIndex !== void 0 && rangeStopIndex !== void 0) {\n      unloadedRanges.push(rangeStartIndex, rangeStopIndex);\n      rangeStartIndex = rangeStopIndex = void 0;\n    }\n  }\n\n  // If :rangeStopIndex is not null it means we haven't run out of unloaded rows.\n  // Scan forward to try filling our :minimumBatchSize.\n  if (rangeStartIndex !== void 0 && rangeStopIndex !== void 0) {\n    const potentialStopIndex = Math.min(\n      Math.max(rangeStopIndex, rangeStartIndex + minimumBatchSize - 1),\n      totalItems - 1\n    );\n\n    /* istanbul ignore next */\n    for (index = rangeStopIndex + 1; index <= potentialStopIndex; index++) {\n      if (!isItemLoaded(index, items)) {\n        rangeStopIndex = index;\n      } else {\n        break;\n      }\n    }\n\n    unloadedRanges.push(rangeStartIndex, rangeStopIndex);\n  }\n\n  // Check to see if our first range ended prematurely.\n  // In this case we should scan backwards to try filling our :minimumBatchSize.\n  /* istanbul ignore next */\n  if (unloadedRanges.length) {\n    let firstUnloadedStart = unloadedRanges[0];\n    const firstUnloadedStop = unloadedRanges[1];\n\n    while (\n      firstUnloadedStop - firstUnloadedStart + 1 < minimumBatchSize &&\n      firstUnloadedStart > 0\n    ) {\n      const index = firstUnloadedStart - 1;\n\n      if (!isItemLoaded(index, items)) {\n        unloadedRanges[0] = firstUnloadedStart = index;\n      } else {\n        break;\n      }\n    }\n  }\n\n  return unloadedRanges;\n}\n\nconst defaultIsItemLoaded = <Item>(index: number, items: Item[]): boolean =>\n  items[index] !== void 0;\n\nexport interface UseInfiniteLoaderOptions<Item> {\n  /**\n   *  A callback responsible for determining the loaded state of each item. Should return `true`\n   * if the item has already been loaded and `false` if not.\n   *\n   * @default (index: number, items: any[]) => boolean\n   */\n  isItemLoaded?: (index: number, items: Item[]) => boolean;\n  /**\n   * The minimum number of new items to be loaded at a time.  This property can be used to\n   * batch requests and reduce HTTP requests.\n   *\n   * @default 16\n   */\n  minimumBatchSize?: number;\n  /**\n   * The threshold at which to pre-fetch data. A threshold X means that new data should start\n   * loading when a user scrolls within X cells of the end of your `items` array.\n   *\n   * @default 16\n   */\n  threshold?: number;\n  /**\n   * The total number of items you'll need to eventually load (if known). This can\n   * be arbitrarily high if not known.\n   *\n   * @default 9e9\n   */\n  totalItems?: number;\n}\n\nexport type LoadMoreItemsCallback<Item> = (\n  startIndex: number,\n  stopIndex: number,\n  items: Item[]\n) => any;\n\nconst emptyObj = {};\n"],"names":["RED","BLACK","NIL","DELETE","KEEP","addInterval","treeNode","high","index","node","list","prevNode","next","removeInterval","NULL_NODE","low","max","C","P","undefined","R","L","updateMax","Math","updateMaxUp","x","rotateLeft","tree","y","root","rotateRight","replaceNode","fixRemove","w","minimumTree","fixInsert","z","createIntervalTree","size","indexMap","insert","remove","intervalResult","originalYColor","search","callback","stack","length","pop","push","curr","useLatest","current","storedValue","React","useRef","useEffect","useDebounceCallback","wait","leading","storedCallback","timeout","deps","clearTimeout","useCallback","args","arguments","setTimeout","apply","useDebounce","initialState","state","useState","usePassiveLayoutEffect","document","createElement","useEvent","target","type","listener","cleanup","storedListener","storedCleanup","useLayoutEffect","targetEl","didUnsubscribe","addEventListener","removeEventListener","emptyObj","win","window","getSize","documentElement","clientWidth","clientHeight","useWindowSize","options","initialWidth","initialHeight","setDebouncedSize","setSize","memoOne","fn","areEqual","equal","defaultAreEqual","value","prev","OneKeyMap","set","get","key","val","k","v","createCache","obj","e","cache","memo","constructors","depth","baseCache","base","map","i","one","g1","s1","g2","s2","g","s","memoize","mapConstructors","item","elementsCache","WeakMap","useForceUpdate","setState","useMasonry","positioner","resizeObserver","items","as","ContainerComponent","id","className","style","role","tabIndex","containerRef","itemAs","ItemComponent","itemStyle","itemHeightEstimate","itemKey","defaultGetItemKey","overscanBy","scrollTop","isScrolling","height","RenderComponent","render","onRender","startIndex","stopIndex","forceUpdate","setItemRef","getRefSetter","itemCount","columnWidth","columnCount","range","estimateHeight","shortestColumn","measuredCount","shortestColumnSize","children","itemRole","storedOnRender","rangeEnd","needsFreshBatch","left","top","data","phaseTwoStyle","width","writingMode","position","process","throwWithoutData","__reactCreateElement__","createRenderElement","min","batchSize","ceil","phaseOneStyle","getCachedSize","didEverMount","containerStyle","getContainerStyle","assignUserStyle","Error","trieMemoize","memoizeOne","maxWidth","maxHeight","willChange","pointerEvents","cmp2","pargs","userStyle","_","zIndex","visibility","el","observe","offsetHeight","u","p","performance","Date","now","af","Caf","Raf","raf","bind","caf","h","lastTime","clearRequestTimeout","handle","requestTimeout","ms","start","loop","call","perf","useThrottleCallback","fps","trailingTimeout","clearTrailing","rightNow","useThrottle","getScrollY","scrollY","pageYOffset","useWindowScroll","useScroller","offset","useScrollPosition","setIsScrolling","didMount","to","MasonryScroller","props","scrollFps","displayName","useContainerPosition","elementRef","emptyArr","containerPosition","setContainerPosition","offsetTop","offsetParent","offsetWidth","usePositioner","columnGutter","rowGutter","initPositioner","getColumns","computedColumnWidth","computedColumnCount","createPositioner","positionerRef","prevDeps","opts","prevOpts","optsChanged","every","prevPositioner","cacheSize","pos","intervalTree","columnHeights","Array","columnItems","column","update","updates","columns","j","itemsInColumn","binarySearch","startItem","lo","hi","renderCallback","defaultItemHeight","tallestColumn","all","a","l","m","minimumWidth","gutter","floor","resizeObservers","ro","activeTargets","hasActiveObservations","some","skippedTargets","hasSkippedObservations","msg","deliverResizeLoopError","event","ErrorEvent","message","createEvent","initEvent","dispatchEvent","ResizeObserverBoxOptions","freeze","Object","ResizeObserverSize","inlineSize","blockSize","DOMRectReadOnly","bottom","right","_a","rectangle","prototype","toJSON","fromRect","isSVG","SVGElement","isHidden","getBBox","_b","getClientRects","isElement","Element","scope","ownerDocument","defaultView","isReplacedElement","tagName","global","scrollRegexp","verticalRegexp","IE","test","navigator","userAgent","parseDimension","pixel","parseFloat","switchSizes","zeroBoxes","devicePixelContentBoxSize","borderBoxSize","contentBoxSize","contentRect","calculateBoxSizes","forceRecalculation","has","cs","getComputedStyle","svg","ownerSVGElement","removePadding","boxSizing","canScrollVertically","overflowY","canScrollHorizontally","overflowX","paddingTop","paddingRight","paddingBottom","paddingLeft","borderTop","borderTopWidth","borderRight","borderRightWidth","borderBottom","borderBottomWidth","borderLeft","borderLeftWidth","horizontalPadding","verticalPadding","horizontalBorderArea","verticalBorderArea","horizontalScrollbarThickness","verticalScrollbarThickness","widthReduction","heightReduction","contentWidth","contentHeight","borderBoxWidth","borderBoxHeight","boxes","round","devicePixelRatio","calculateBoxSize","observedBox","DEVICE_PIXEL_CONTENT_BOX","BORDER_BOX","ResizeObserverEntry","calculateDepthForNode","Infinity","parent","parentNode","broadcastActiveObservations","shallowestDepth","callbacks","forEach","processObserver","entries","processTarget","ot","entry","targetDepth","lastReportedSize","resizeObserverCallback","observer","splice","_i","callbacks_1","gatherActiveObservationsAtDepth","observationTargets","isActive","trigger","cb","notify","queueMicroTask","el_1","textContent","toggle_1","createTextNode","config","characterData","MutationObserver","queueResizeObserver","ResizeObserver","requestAnimationFrame","watching","isWatching","CATCH_PERIOD","observerConfig","attributes","childList","subtree","events","time","scheduled","Scheduler","_this","stopped","schedule","until","elementsHaveResized","run","stop","body","name","disconnect","scheduler","updateCount","n","skipNotifyOnElement","display","ResizeObservation","CONTENT_BOX","ResizeObserverDetail","observerMap","getObservationIndex","ResizeObserverController","detail","firstObservation","box","lastObservation","indexOf","slice","unobserve","connect","TypeError","toString","rafSchd","lastArgs","frameId","wrapperFn","_len","_key","cancel","cancelAnimationFrame","Polyfill","useResizeObserver","createResizeObserver","updater","handleEntries","useScrollToIndex","align","element","innerHeight","latestOptions","getTarget","latestElement","useReducer","action","nextState","prevTop","defaultState","dispatch","throttledDispatch","currentTop","scrollTo","estimatedTop","Masonry","windowSize","ssrWidth","ssrHeight","containerPos","nextProps","scrollToIndex","List","useInfiniteLoader","loadMoreItems","isItemLoaded","minimumBatchSize","threshold","totalItems","storedLoadMoreItems","storedIsItemLoaded","unloadedRanges","scanForUnloadedRanges","defaultIsItemLoaded","rangeStartIndex","rangeStopIndex","potentialStopIndex","firstUnloadedStart","firstUnloadedStop"],"mappings":"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"}